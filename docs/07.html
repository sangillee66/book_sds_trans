<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>공간데이터사이언스 개론 - 7&nbsp; sf와 stars</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08.html" rel="next">
<link href="./part_2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title"><span id="sec-sf-stars" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">sf와 stars</span></span></h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">공간데이터사이언스 개론</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/sangillee66/book_sds_trans" title="소스 코드" class="quarto-navigation-tool px-1" aria-label="소스 코드"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="검색"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">서장</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">공간데이터</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">시작하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">좌표계</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">지오메트리</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">구체 지오메트리</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">속성과 서포트</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">데이터 큐브</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">공간데이터사이언스와 R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">sf와 stars</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">공간데이터의 시각화</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">대용량 데이터와 클라우드 네이티브</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">공간통계분석과 공간모델링</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">공간데이터의 통계적 모델링</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">포인트패턴 분석</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">공간적 인터폴레이션</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">다변량 및 시공간 지구통계학</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">근접성과 에어리어 데이터</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">공간적 자기상관 측도</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">공간적 회귀분석</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">공간계량경제학적 모델</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">부록</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">R 스페셜 패키지</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">R 기초</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">목차</h2>
   
  <ul>
<li>
<a href="#sec-sf" id="toc-sec-sf" class="nav-link active" data-scroll-target="#sec-sf"><span class="header-section-number">7.1</span> sf 패키지</a>
  <ul class="collapse">
<li><a href="#%EC%83%9D%EC%84%B1" id="toc-생성" class="nav-link" data-scroll-target="#%EC%83%9D%EC%84%B1"><span class="header-section-number">7.1.1</span> 생성</a></li>
  <li><a href="#%EC%9D%BD%EC%96%B4%EC%98%A4%EA%B8%B0%EC%99%80-%EC%93%B0%EA%B8%B0" id="toc-읽어오기와-쓰기" class="nav-link" data-scroll-target="#%EC%9D%BD%EC%96%B4%EC%98%A4%EA%B8%B0%EC%99%80-%EC%93%B0%EA%B8%B0"><span class="header-section-number">7.1.2</span> 읽어오기와 쓰기</a></li>
  <li><a href="#%EB%B6%80%EB%B6%84%EC%9D%84-%EA%B3%A8%EB%9D%BC%EB%82%B4%EA%B8%B0" id="toc-부분을-골라내기" class="nav-link" data-scroll-target="#%EB%B6%80%EB%B6%84%EC%9D%84-%EA%B3%A8%EB%9D%BC%EB%82%B4%EA%B8%B0"><span class="header-section-number">7.1.3</span> 부분을 골라내기</a></li>
  <li><a href="#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%ED%94%84%EB%A0%88%EB%94%94%EC%BC%80%EC%9D%B4%ED%8A%B8" id="toc-바이너리-프레디케이트" class="nav-link" data-scroll-target="#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%ED%94%84%EB%A0%88%EB%94%94%EC%BC%80%EC%9D%B4%ED%8A%B8"><span class="header-section-number">7.1.4</span> 바이너리 프레디케이트</a></li>
  <li><a href="#%ED%83%80%EC%9D%B4%EB%94%94%EB%B2%84%EC%8A%A4" id="toc-타이디버스" class="nav-link" data-scroll-target="#%ED%83%80%EC%9D%B4%EB%94%94%EB%B2%84%EC%8A%A4"><span class="header-section-number">7.1.5</span> 타이디버스</a></li>
  </ul>
</li>
  <li>
<a href="#%EA%B3%B5%EA%B0%84%EC%A0%81-%EC%A1%B0%EC%9D%B8" id="toc-공간적-조인" class="nav-link" data-scroll-target="#%EA%B3%B5%EA%B0%84%EC%A0%81-%EC%A1%B0%EC%9D%B8"><span class="header-section-number">7.2</span> 공간적 조인</a>
  <ul class="collapse">
<li><a href="#%EC%83%98%ED%94%8C%EB%A7%81-%EA%B7%B8%EB%A6%AC%EB%94%A9-%EC%9D%B8%ED%84%B0%ED%8F%B4%EB%A0%88%EC%9D%B4%ED%8C%85" id="toc-샘플링-그리딩-인터폴레이팅" class="nav-link" data-scroll-target="#%EC%83%98%ED%94%8C%EB%A7%81-%EA%B7%B8%EB%A6%AC%EB%94%A9-%EC%9D%B8%ED%84%B0%ED%8F%B4%EB%A0%88%EC%9D%B4%ED%8C%85"><span class="header-section-number">7.2.1</span> 샘플링, 그리딩, 인터폴레이팅</a></li>
  </ul>
</li>
  <li><a href="#%ED%83%80%EC%9B%90-%EC%A2%8C%ED%91%9C" id="toc-타원-좌표" class="nav-link" data-scroll-target="#%ED%83%80%EC%9B%90-%EC%A2%8C%ED%91%9C"><span class="header-section-number">7.3</span> 타원 좌표</a></li>
  <li>
<a href="#stars-%ED%8C%A8%ED%82%A4%EC%A7%80" id="toc-stars-패키지" class="nav-link" data-scroll-target="#stars-%ED%8C%A8%ED%82%A4%EC%A7%80"><span class="header-section-number">7.4</span> stars 패키지</a>
  <ul class="collapse">
<li><a href="#%EB%9E%98%EC%8A%A4%ED%84%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9D%98-%EC%9D%BD%EA%B8%B0%EC%99%80-%EC%93%B0%EA%B8%B0" id="toc-래스터-데이터의-읽기와-쓰기" class="nav-link" data-scroll-target="#%EB%9E%98%EC%8A%A4%ED%84%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9D%98-%EC%9D%BD%EA%B8%B0%EC%99%80-%EC%93%B0%EA%B8%B0"><span class="header-section-number">7.4.1</span> 래스터 데이터의 읽기와 쓰기</a></li>
  <li><a href="#stars-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%81%90%EB%B8%8C%EB%A1%9C%EB%B6%80%ED%84%B0-%EC%9D%BC%EB%B6%80%EB%B6%84-%EA%B3%A8%EB%9D%BC%EB%82%B4%EA%B8%B0" id="toc-stars-데이터-큐브로부터-일부분-골라내기" class="nav-link" data-scroll-target="#stars-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%81%90%EB%B8%8C%EB%A1%9C%EB%B6%80%ED%84%B0-%EC%9D%BC%EB%B6%80%EB%B6%84-%EA%B3%A8%EB%9D%BC%EB%82%B4%EA%B8%B0"><span class="header-section-number">7.4.2</span> <code>stars</code> 데이터 큐브로부터 일부분 골라내기</a></li>
  <li><a href="#%EC%9E%98%EB%9D%BC%EB%82%B4%EA%B8%B0" id="toc-잘라내기" class="nav-link" data-scroll-target="#%EC%9E%98%EB%9D%BC%EB%82%B4%EA%B8%B0"><span class="header-section-number">7.4.3</span> 잘라내기</a></li>
  <li><a href="#stars-%EA%B0%9D%EC%B2%B4%EC%9D%98-%EC%B0%A8%EC%9B%90%EC%9E%AC%EB%B6%80%EC%97%AC-%EB%B0%8F-%EA%B2%B0%ED%95%A9" id="toc-stars-객체의-차원재부여-및-결합" class="nav-link" data-scroll-target="#stars-%EA%B0%9D%EC%B2%B4%EC%9D%98-%EC%B0%A8%EC%9B%90%EC%9E%AC%EB%B6%80%EC%97%AC-%EB%B0%8F-%EA%B2%B0%ED%95%A9"><span class="header-section-number">7.4.4</span> stars 객체의 차원재부여 및 결합</a></li>
  <li><a href="#%ED%8F%AC%EC%9D%B8%ED%8A%B8-%EC%83%98%ED%94%8C-%EC%B6%94%EC%B6%9C%ED%95%98%EA%B8%B0-%EC%95%A0%EA%B7%B8%EB%A6%AC%EA%B2%8C%EC%9D%B4%ED%8C%85%ED%95%98%EA%B8%B0" id="toc-포인트-샘플-추출하기-애그리게이팅하기" class="nav-link" data-scroll-target="#%ED%8F%AC%EC%9D%B8%ED%8A%B8-%EC%83%98%ED%94%8C-%EC%B6%94%EC%B6%9C%ED%95%98%EA%B8%B0-%EC%95%A0%EA%B7%B8%EB%A6%AC%EA%B2%8C%EC%9D%B4%ED%8C%85%ED%95%98%EA%B8%B0"><span class="header-section-number">7.4.5</span> 포인트 샘플 추출하기, 애그리게이팅하기</a></li>
  <li><a href="#%EC%98%88%EC%B8%A1-%EB%AA%A8%EB%8D%B8" id="toc-예측-모델" class="nav-link" data-scroll-target="#%EC%98%88%EC%B8%A1-%EB%AA%A8%EB%8D%B8"><span class="header-section-number">7.4.6</span> 예측 모델</a></li>
  <li><a href="#%EB%9E%98%EC%8A%A4%ED%84%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%94%8C%EB%A1%9C%ED%8C%85" id="toc-래스터-데이터-플로팅" class="nav-link" data-scroll-target="#%EB%9E%98%EC%8A%A4%ED%84%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%94%8C%EB%A1%9C%ED%8C%85"><span class="header-section-number">7.4.7</span> 래스터 데이터 플로팅</a></li>
  <li><a href="#%EB%9E%98%EC%8A%A4%ED%84%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D%ED%95%98%EA%B8%B0" id="toc-래스터-데이터-분석하기" class="nav-link" data-scroll-target="#%EB%9E%98%EC%8A%A4%ED%84%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D%ED%95%98%EA%B8%B0"><span class="header-section-number">7.4.8</span> 래스터 데이터 분석하기</a></li>
  <li><a href="#%EA%B3%A1%EC%84%A0-%EB%9E%98%EC%8A%A4%ED%84%B0" id="toc-곡선-래스터" class="nav-link" data-scroll-target="#%EA%B3%A1%EC%84%A0-%EB%9E%98%EC%8A%A4%ED%84%B0"><span class="header-section-number">7.4.9</span> 곡선 래스터</a></li>
  <li><a href="#goal-utils" id="toc-goal-utils" class="nav-link" data-scroll-target="#goal-utils"><span class="header-section-number">7.4.10</span> GOAL utils</a></li>
  </ul>
</li>
  <li>
<a href="#%EB%B2%A1%ED%84%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%81%90%EB%B8%8C-%EC%82%AC%EB%A1%80" id="toc-벡터-데이터-큐브-사례" class="nav-link" data-scroll-target="#%EB%B2%A1%ED%84%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%81%90%EB%B8%8C-%EC%82%AC%EB%A1%80"><span class="header-section-number">7.5</span> 벡터 데이터 큐브 사례</a>
  <ul class="collapse">
<li><a href="#%EC%82%AC%EB%A1%80-%EB%8C%80%EA%B8%B0%EC%A7%88-%EC%8B%9C%EA%B3%84%EC%97%B4-%EC%95%A0%EA%B7%B8%EB%A6%AC%EA%B2%8C%EC%9D%B4%ED%8C%85%ED%95%98%EA%B8%B0" id="toc-사례-대기질-시계열-애그리게이팅하기" class="nav-link" data-scroll-target="#%EC%82%AC%EB%A1%80-%EB%8C%80%EA%B8%B0%EC%A7%88-%EC%8B%9C%EA%B3%84%EC%97%B4-%EC%95%A0%EA%B7%B8%EB%A6%AC%EA%B2%8C%EC%9D%B4%ED%8C%85%ED%95%98%EA%B8%B0"><span class="header-section-number">7.5.1</span> 사례: 대기질 시계열 애그리게이팅하기</a></li>
  <li><a href="#%EC%82%AC%EB%A1%80-%EB%B8%8C%EB%A6%AC%EC%8A%A4%ED%86%A8-%EC%B6%9C%EB%B0%9C%EC%A7%80-%EB%8F%84%EC%B0%A9%EC%A7%80-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%81%90%EB%B8%8C" id="toc-사례-브리스톨-출발지-도착지-데이터-큐브" class="nav-link" data-scroll-target="#%EC%82%AC%EB%A1%80-%EB%B8%8C%EB%A6%AC%EC%8A%A4%ED%86%A8-%EC%B6%9C%EB%B0%9C%EC%A7%80-%EB%8F%84%EC%B0%A9%EC%A7%80-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%81%90%EB%B8%8C"><span class="header-section-number">7.5.2</span> 사례: 브리스톨 출발지-도착지 데이터 큐브</a></li>
  <li><a href="#%ED%83%80%EC%9D%B4%EB%94%94-%EC%96%B4%EB%A0%88%EC%9D%B4-%EB%8D%B0%EC%9D%B4%ED%84%B0" id="toc-타이디-어레이-데이터" class="nav-link" data-scroll-target="#%ED%83%80%EC%9D%B4%EB%94%94-%EC%96%B4%EB%A0%88%EC%9D%B4-%EB%8D%B0%EC%9D%B4%ED%84%B0"><span class="header-section-number">7.5.3</span> 타이디 어레이 데이터</a></li>
  <li><a href="#%EB%B2%A1%ED%84%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%81%90%EB%B8%8C%EB%A5%BC-%EC%9C%84%ED%95%9C-%ED%8C%8C%EC%9D%BC-%ED%8F%AC%EB%A9%A7" id="toc-벡터-데이터-큐브를-위한-파일-포멧" class="nav-link" data-scroll-target="#%EB%B2%A1%ED%84%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%81%90%EB%B8%8C%EB%A5%BC-%EC%9C%84%ED%95%9C-%ED%8C%8C%EC%9D%BC-%ED%8F%AC%EB%A9%A7"><span class="header-section-number">7.5.4</span> 벡터 데이터 큐브를 위한 파일 포멧</a></li>
  </ul>
</li>
  <li>
<a href="#%EB%9E%98%EC%8A%A4%ED%84%B0-%ED%88%AC-%EB%B2%A1%ED%84%B0%EC%99%80-%EB%B2%A1%ED%84%B0-%ED%88%AC-%EB%9E%98%EC%8A%A4%ED%84%B0" id="toc-래스터-투-벡터와-벡터-투-래스터" class="nav-link" data-scroll-target="#%EB%9E%98%EC%8A%A4%ED%84%B0-%ED%88%AC-%EB%B2%A1%ED%84%B0%EC%99%80-%EB%B2%A1%ED%84%B0-%ED%88%AC-%EB%9E%98%EC%8A%A4%ED%84%B0"><span class="header-section-number">7.6</span> 래스터-투-벡터와 벡터-투-래스터</a>
  <ul class="collapse">
<li><a href="#%EB%B2%A1%ED%84%B0-%ED%88%AC-%EB%9E%98%EC%8A%A4%ED%84%B0" id="toc-벡터-투-래스터" class="nav-link" data-scroll-target="#%EB%B2%A1%ED%84%B0-%ED%88%AC-%EB%9E%98%EC%8A%A4%ED%84%B0"><span class="header-section-number">7.6.1</span> 벡터-투-래스터</a></li>
  </ul>
</li>
  <li>
<a href="#%EC%A2%8C%ED%91%9C%EB%B3%80%ED%99%98-%EB%B0%8F-%EC%A2%8C%ED%91%9C%EC%A0%84%ED%99%98" id="toc-좌표변환-및-좌표전환" class="nav-link" data-scroll-target="#%EC%A2%8C%ED%91%9C%EB%B3%80%ED%99%98-%EB%B0%8F-%EC%A2%8C%ED%91%9C%EC%A0%84%ED%99%98"><span class="header-section-number">7.7</span> 좌표변환 및 좌표전환</a>
  <ul class="collapse">
<li><a href="#%EB%8D%B0%EC%9D%B4%ED%85%80-%EA%B7%B8%EB%A6%AC%EB%93%9C-proj.db-cdn.proj.org.-%EB%A1%9C%EC%BB%AC-%EC%BA%90%EC%89%AC" id="toc-데이텀-그리드-proj.db-cdn.proj.org.-로컬-캐쉬" class="nav-link" data-scroll-target="#%EB%8D%B0%EC%9D%B4%ED%85%80-%EA%B7%B8%EB%A6%AC%EB%93%9C-proj.db-cdn.proj.org.-%EB%A1%9C%EC%BB%AC-%EC%BA%90%EC%89%AC"><span class="header-section-number">7.7.1</span> 데이텀 그리드, proj.db, cdn.proj.org. 로컬 캐쉬</a></li>
  <li><a href="#%EB%B3%80%ED%99%98-%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8" id="toc-변환-파이프라인" class="nav-link" data-scroll-target="#%EB%B3%80%ED%99%98-%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8"><span class="header-section-number">7.7.2</span> 변환 파이프라인</a></li>
  <li><a href="#%EC%B6%95-%EC%88%9C%EC%84%9C%EC%99%80-%EB%B0%A9%ED%96%A5" id="toc-축-순서와-방향" class="nav-link" data-scroll-target="#%EC%B6%95-%EC%88%9C%EC%84%9C%EC%99%80-%EB%B0%A9%ED%96%A5"><span class="header-section-number">7.7.3</span> 축 순서와 방향</a></li>
  </ul>
</li>
  <li><a href="#%EB%9E%98%EC%8A%A4%ED%84%B0-%EB%B3%80%ED%99%98-%EB%B0%8F-%EC%9B%8C%ED%94%84" id="toc-래스터-변환-및-워프" class="nav-link" data-scroll-target="#%EB%9E%98%EC%8A%A4%ED%84%B0-%EB%B3%80%ED%99%98-%EB%B0%8F-%EC%9B%8C%ED%94%84"><span class="header-section-number">7.8</span> 래스터 변환 및 워프</a></li>
  <li><a href="#%EC%97%B0%EC%8A%B5%EB%AC%B8%EC%A0%9C" id="toc-연습문제" class="nav-link" data-scroll-target="#%EC%97%B0%EC%8A%B5%EB%AC%B8%EC%A0%9C"><span class="header-section-number">7.9</span> 연습문제</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/sangillee66/book_sds_trans/issues/new" class="toc-action"><i class="bi bi-github"></i>이슈 보고</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block"><span id="sec-sf-stars" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">sf와 stars</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">2024년 10월 11일</p>
    </div>
  </div>
    
  </div>
  


</header><p>이 장에서는 R 패키지인 <strong>sf</strong>와 <strong>stars</strong>를 소개한다. <strong>sf</strong>는 피처의 기하 정보를 리스트-컬럼에 저장하는 단순 피처의 테이블 포맷을 제공한다. <strong>stars</strong> 패키지는 래스터와 벡터 데이터 큐브(6장에서 다룸)를 지원하기 위해 작성되었으며, 래스터 레이어, 래스터 스택 및 피처 시계열 또한 지원한다. <strong>sf</strong>는 2016년에 CRAN에 처음 등장했고, <strong>stars</strong>는 2018년에 등장했다. 두 패키지의 개발은 R 컨소시엄의 지원과 강력한 커뮤니티 참여로 이루어졌다. 이 패키지들은 함께 작동하도록 설계되었다. <strong>sf</strong>나 <strong>stars</strong> 객체를 대상으로 하는 함수 또는 메서드는 <code>st_</code>로 시작하는데, 쉽게 관련 함수를 인식할 수 있을 뿐만 아니라 명령어 완성 기능을 사용할 때 검색의 용이함이 있다.</p>
<section id="sec-sf" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="sec-sf">
<span class="header-section-number">7.1</span> sf 패키지</h2>
<p>R 패키지 <strong>sf</strong>(Pebesma 2018)는 기존의 R 패키지인 <strong>sp</strong>, r<strong>geos</strong> 및 <strong>rgdal</strong>의 벡터 부분을 대체하고 성공적으로 이어받기 위해 개발되었으며, 산업계 및 오픈 소스 프로젝트에서 볼 수 있는 표준 기반 접근법에 더 가까이 다가가고, 최신 버전의 오픈소스 지리공간 소프트웨어 스택(그림 1.7)을 기반으로 하며, 필요 시 R 공간 소프트웨어와 타이디버스(Wickham et al.&nbsp;2019)의 통합을 가능하게 한다.</p>
<p>이를 위해 <strong>sf</strong>는 R에 네이티브로 심플 피처 접근(Herring et al.&nbsp;2011)을 제공한다. 이 패키지는 여러 타이디버스 패키지, 특히 <strong>ggplot2</strong>, <strong>dplyr</strong>, <strong>tidyr</strong>와의 인터페이스를 제공하며, GDAL을 통해 데이터를 읽고 쓰고, GEOS(투영 좌표의 경우) 또는 s2geometry(타원체 좌표의 경우)를 사용하여 기하학적 연산을 수행하며, PROJ를 이용해 좌표 변환 또는 좌표 전환 작업을 수행할 수 있다. 외부 C++ 라이브러리와의 인터페이싱(연결)은 <strong>Rcpp</strong> 패키지(Eddelbuettel 2013)를 통해 이루어진다.</p>
<p><strong>sf</strong>는 <code>sf</code> 객체로 심플 피처를 나타내며, 이는 <code>data.frame</code> 또는 티블(tibble)의 하위 클래스이다. <code>sf</code> 객체는 최소 하나 이상의 <code>sfc</code> 클래스의 지오메트리 <em>리스트 열</em>(list-column)을 포함하는데, 각 요소는 <code>sfg</code> 클래스의 R 객체로서 지오메트리 정보를 담고 있다. 지오메트리 리스트 열은 <code>data.frame</code> 또는 티블 내에서 변수처럼 작동하지만, 숫자나 문자형 변수와 같은 기본 벡터보다 더 복잡한 구조를 가지고 있다(부록 B.3 참조).</p>
<p><code>sf</code> 객체는 다음과 같은 메타데이터를 가진다.</p>
<ul>
<li><p>(활성화된) 지오메트리 열의 이름: <code>sf_column</code> 속성에 저장되어 있음.</p></li>
<li><p>각 비기하 변수의 속성-지오메트리 관계 (5.1절 참조): <code>agr</code> 속성에 저장되어 있음.</p></li>
</ul>
<p><code>sfc</code> 지오메트리 리스트 열은 <code>st_geometry</code>함수를 통해 <code>sf</code> 객체에서 추출되며, 다음과 같은 메타데이터를 가진다</p>
<ul>
<li><p>좌표참조계: <code>crs</code> 속성에 저장되어 있음.</p></li>
<li><p>바운딩 박스: <code>bbox</code> 속성에 저장되어 있음.</p></li>
<li><p>정밀도: <code>precision</code> 속성에 저장되어 있음.</p></li>
<li><p>지오메트리 수: <code>n_empty</code> 속성에 저장되어 있음.</p></li>
</ul>
<p>이러한 속성들의 값을 확인하거나 수정하기 위해 <code>st_bbox</code>, <code>st_crs</code>, <code>st_set_crs</code>, <code>st_agr</code>, <code>st_set_agr</code>, <code>st_precision</code>, <code>st_set_precision</code> 같은 함수를 사용할 수 있다.</p>
<section id="생성" class="level3" data-number="7.1.1"><h3 data-number="7.1.1" class="anchored" data-anchor-id="생성">
<span class="header-section-number">7.1.1</span> 생성</h3>
<p>다음과 같은 방식으로 <code>sf</code> 객체를 생성할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="co"># Linking to GEOS 3.11.1, GDAL 3.6.4, PROJ 9.1.1; sf_use_s2() is TRUE</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7.35</span>, <span class="fl">52.42</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7.22</span>, <span class="fl">52.18</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7.44</span>, <span class="fl">52.19</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sfc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span><span class="op">)</span>, crs <span class="op">=</span> <span class="st">'OGC:CRS84'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span>elev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">33.2</span>, <span class="fl">52.1</span>, <span class="fl">81.2</span><span class="op">)</span>, </span>
<span>      marker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Id01"</span>, <span class="st">"Id02"</span>, <span class="st">"Id03"</span><span class="op">)</span>, geom <span class="op">=</span> <span class="va">sfc</span><span class="op">)</span></span>
<span><span class="co"># Simple feature collection with 3 features and 2 fields</span></span>
<span><span class="co"># Geometry type: POINT</span></span>
<span><span class="co"># Dimension:     XY</span></span>
<span><span class="co"># Bounding box:  xmin: 7.22 ymin: 52.2 xmax: 7.44 ymax: 52.4</span></span>
<span><span class="co"># Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#   elev marker              geom</span></span>
<span><span class="co"># 1 33.2   Id01 POINT (7.35 52.4)</span></span>
<span><span class="co"># 2 52.1   Id02 POINT (7.22 52.2)</span></span>
<span><span class="co"># 3 81.2   Id03 POINT (7.44 52.2)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-7-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-7-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://r-spatial.org/book/images/sf_obj.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" data-glightbox="description: .lightbox-desc-1"><img src="https://r-spatial.org/book/images/sf_obj.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-7-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;7.1: sf 객체의 구조
</figcaption></figure>
</div>
<p>그림 7.1은 출력된 구성 요소에 대한 설명을 제공한다. 객체를 처음부터 생성하는 대신, R에서의 공간데이터는 보통 외부 소스에서 읽어오며, 그 외부 소스에는 다음과 같은 것이 있다.</p>
<ul>
<li><p>외부 파일</p></li>
<li><p>데이터베이스 내의 테이블(또는 테이블 집합)</p></li>
<li><p>웹서비스에서 호출을 통해 획득된 데이터셋</p></li>
<li><p>R 패키지에 포함되어 있는 데이터셋</p></li>
</ul></section><section id="읽어오기와-쓰기" class="level3" data-number="7.1.2"><h3 data-number="7.1.2" class="anchored" data-anchor-id="읽어오기와-쓰기">
<span class="header-section-number">7.1.2</span> 읽어오기와 쓰기</h3>
<p>외부 “데이터 소스”(파일, 웹서비스 또는 문자열)로부터 데이터셋을 읽어오는 것은 <code><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read()</a></code> 함수를 사용하여 수행된다.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"gpkg/nc.gpkg"</span>, package <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [1] "/home/edzer/R/x86_64-pc-linux-gnu-library/4.3/sf/gpkg/nc.gpkg"</span></span>
<span><span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span><span class="co"># Reading layer `nc.gpkg' from data source </span></span>
<span><span class="co">#   `/home/edzer/R/x86_64-pc-linux-gnu-library/4.3/sf/gpkg/nc.gpkg' </span></span>
<span><span class="co">#   using driver `GPKG'</span></span>
<span><span class="co"># Simple feature collection with 100 features and 14 fields</span></span>
<span><span class="co"># Geometry type: MULTIPOLYGON</span></span>
<span><span class="co"># Dimension:     XY</span></span>
<span><span class="co"># Bounding box:  xmin: -84.3 ymin: 33.9 xmax: -75.5 ymax: 36.6</span></span>
<span><span class="co"># Geodetic CRS:  NAD27</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>여기서 파일 이름과 경로는 sf 패키지에서 읽어오는 것인데, sf 패키지를 설치하는 과정에서 설정된 것이므로 어떤 컴퓨터에서건 예외없이 읽어들여진다.</p>
<p><code><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read()</a></code> 명령어는 두 개의 아규먼트(<em>데이터 소스 이름</em>(dsn)과 <em>레이어</em>(layer))를 가진다. 위의 예에서 <em>geopackage</em>(GPKG) 파일은 단일 레이어만 포함하고 있으며, 해당 레이어가 불러들여진 것이다. 만약 여러 레이어가 포함되어 있었다면, 첫 번째 레이어가 읽히고 경고 메시지가 표출되었을 것이다. 데이터셋의 사용 가능한 레이어는 다음과 같이 조회할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_layers.html">st_layers</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span><span class="co"># Driver: GPKG </span></span>
<span><span class="co"># Available layers:</span></span>
<span><span class="co">#   layer_name geometry_type features fields crs_name</span></span>
<span><span class="co"># 1    nc.gpkg Multi Polygon      100     14    NAD27</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>심플 피처 객체는 <code>st_write</code> 함수를 사용하여 저장할수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".gpkg"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [1] "/tmp/Rtmpm9lGRF/file361e653fae4a9.gpkg"</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html">st_write</a></span><span class="op">(</span><span class="va">nc</span>, <span class="va">file</span>, layer <span class="op">=</span> <span class="st">"layer_nc"</span><span class="op">)</span></span>
<span><span class="co"># Writing layer `layer_nc' to data source </span></span>
<span><span class="co">#   `/tmp/Rtmpm9lGRF/file361e653fae4a9.gpkg' using driver `GPKG'</span></span>
<span><span class="co"># Writing 100 features with 14 fields and geometry type Multi Polygon.</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>여기서 파일 형식(GPKG)은 파일 이름 익스텐션에서 파생된다. <code><a href="https://r-spatial.github.io/sf/reference/st_write.html">st_write()</a></code> 함수의 <code>append</code> 아규먼트 설정을 통해 기존 레이어에 레코드를 추가하거나 아예 레이어를 교체할 수 있는데, <code>append</code> 아규먼트 설정되지 않으면 레이어가 이미 존재할 경우 오류가 발생한다. 타이디버스 스타일의 <code><a href="https://r-spatial.github.io/sf/reference/st_write.html">write_sf()</a></code> 함수는 <code>append</code>가 설정되지 않은 경우 오류 표출 없이 레이어를 교체한다. 또한, <code><a href="https://r-spatial.github.io/sf/reference/st_write.html">st_delete()</a></code> 함수를 사용하여 레이어를 삭제할 수 있으며, 이는 특히 데이터베이스의 테이블과 연결되어 있는 레이어를 다룰 때 편리하다.</p>
<p>WKT-2 좌표참조계를 지원하는 파일 형식의 경우, <code><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read()</a></code>와 <code><a href="https://r-spatial.github.io/sf/reference/st_write.html">st_write()</a></code>는 이를 읽고 쓸 수 있다. 그러나 <code>csv</code>와 같은 간단한 포맷에서는 이 기능이 작동하지 않는다. 또한, 셰이프파일(shapefile) 형식은 CRS에 대해 매우 제한된 인코딩만 지원한다.</p>
</section><section id="부분을-골라내기" class="level3" data-number="7.1.3"><h3 data-number="7.1.3" class="anchored" data-anchor-id="부분을-골라내기">
<span class="header-section-number">7.1.3</span> 부분을 골라내기</h3>
<p>매우 일반적인 작업 중 하나는 객체의 일부분을 골라내기(subset)하는 것이며, 베이스 R에서는 이를 위해 대괄호 기호([) 를 사용한다. <code>data.frame</code> 객체에 적용되는 규칙을 sf 객체에 그대로 적용할 수 있다. 예를 들어, 다음과 같은 코드를 통해 레코드 2에서 5와 열 3에서 7을 선택할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nc</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>여기에 몇몇 옵션을 부가적으로 적용할 수 있다.</p>
<ul>
<li><p><code>drop</code> 아규먼트가 디폴트로 FALSE로 설정되어 있는데, 지오메트리 열이 <em>항상</em> 선택되며 <code>sf</code> 객체가 반환된다. TRUE로 설정되면, 지오메트리열이 선택되지 않으면 해당 열이 제거된 <code>data.frame</code>이 반환된다.</p></li>
<li><p>공간(<code>sf</code>, <code>sfc</code> 또는 <code>sfg</code>) 객체를 첫 번째 아규먼트로 사용한 선택은 해당 객체와 공간적으로 <em>교차</em>하는 피처를 선택하는 결과를 가져온다(다음 절 참조). 다른 프레디케이트를 선택하고자 할 경우, <strong>op</strong> 아규먼트를 설정하여 <code>st_covers</code>와 같은 함수 또는 3.2.2절에 나열된 다른 이항 프레디케이트 함수로 지정할 수 있다.</p></li>
</ul></section><section id="바이너리-프레디케이트" class="level3" data-number="7.1.4"><h3 data-number="7.1.4" class="anchored" data-anchor-id="바이너리-프레디케이트">
<span class="header-section-number">7.1.4</span> 바이너리 프레디케이트</h3>
<p><code>st_intersects</code>, <code>st_covers</code>와 같은 이항 프레디케이트 함수(3.2.2절 참조)는 두 개의 피처 집합 또는 피처 지오메트리를 입력받아 모든 쌍에 대해 조건이 TRUE인지 FALSE인지를 반환한다. 대규모 집합의 경우, 이는 일반적으로 대부분 FALSE 값으로 채워진 거대한 행렬을 생성할 수 있으며, 이러한 이유로 기본적으로 희소 표현(sparse representation)이 반환된다(역자주: 희소 표현은 메모리 사용을 최적화하고, 데이터 처리를 더욱 효율적으로 만들어 준다. 희소 표현을 일반적으로 TRUE 값만을 저장하고, FALSE 값은 저장하지 않는다.)</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nc5</span> <span class="op">&lt;-</span> <span class="va">nc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span>
<span><span class="va">nc7</span> <span class="op">&lt;-</span> <span class="va">nc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="op">]</span></span>
<span><span class="op">(</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">st_intersects</a></span><span class="op">(</span><span class="va">nc5</span>, <span class="va">nc7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Sparse geometry binary predicate list of length 5, where the</span></span>
<span><span class="co"># predicate was `intersects'</span></span>
<span><span class="co">#  1: 1, 2</span></span>
<span><span class="co">#  2: 1, 2, 3</span></span>
<span><span class="co">#  3: 2, 3</span></span>
<span><span class="co">#  4: 4, 7</span></span>
<span><span class="co">#  5: 5, 6</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-7-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-7-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07_files/figure-html/fig-7-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" data-glightbox="description: .lightbox-desc-2"><img src="07_files/figure-html/fig-7-2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-7-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;7.2: 노스케롤라이나의 첫 7개의 카운티
</figcaption></figure>
</div>
</div>
</div>
<p>그림 7.2는 첫 다섯 개 카운티와 첫 일곱 개 카운티의 교차를 이해하는 방법을 보여준다. 다음과 같은 방식으로 희소 논리 행렬을 조밀한 행렬(dense matrix)로 변환할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="co">#       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]</span></span>
<span><span class="co"># [1,]  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co"># [2,]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co"># [3,] FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co"># [4,] FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE</span></span>
<span><span class="co"># [5,] FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>nc5</code>의 개별 카운티가 교차하는 <code>nc7</code> 카운티의 수는 다음과 같이 계산할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 3 2 2 2</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># [1] 2 3 2 2 2</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>역으로 <code>nc7</code>의 개별 카운티가 교차하는 <code>nc5</code>의 카운티의 수는 다음과 같이 계산할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [1] 2 3 2 1 1 1 1</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>객체 <code>i</code> 가 <code>sgbp</code>(sparse geometrical binary predicate) 클래스의 한 객체라고 했을 때, 객체 <code>i</code>는 정수 벡터의 리스트로 주어지는데, 리스트의 각 요소는 논리 프레디케이트 행렬의 한 행을 나타내고, 논리 프레디케이트 행렬은 해당 행에 대해 TRUE 값을 갖는 열의 인덱스를 보유하고 있다. 이 객체는 사용된 프레디케이트 및 총 열 수와 같은 메타데이터도 포함하고 있다. sgbp 객체에 적용할 수 있는 메소드에 다음과 같은 것들이 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html">methods</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"sgbp"</span><span class="op">)</span></span>
<span><span class="co">#  [1] as.data.frame as.matrix     coerce        dim          </span></span>
<span><span class="co">#  [5] initialize    Ops           print         show         </span></span>
<span><span class="co">#  [9] slotsFromS3   t            </span></span>
<span><span class="co"># see '?methods' for accessing help and source code</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>sgbp</code> 클래스의 객체에서 사용 가능한 유일한 <code>Ops</code> 메서드는 <code>!</code>(부정 연산자)이다.</p>
</section><section id="타이디버스" class="level3" data-number="7.1.5"><h3 data-number="7.1.5" class="anchored" data-anchor-id="타이디버스">
<span class="header-section-number">7.1.5</span> 타이디버스</h3>
<p><strong>tidyverse</strong> 패키지는 다양한 데이터사이언스 패키지를 함께 로드한다(Wickham and Grolemund 2017; Wickham et al.&nbsp;2019). <strong>sf</strong> 패키지는 <strong>tidyverse</strong> 스타일의 읽기 및 쓰기 함수인 read_sf()와 write_sf()를 제공하며, 이 함수들은 다음과 같은 특징이 있다.</p>
<ul>
<li><p><code>data.frame</code> 대신 <code>tibble</code>을 반환한다.</p></li>
<li><p>출력 내용을 인쇄하지 않는다.</p></li>
<li><p>기본적으로 기본 데이터를 덮어쓴다.</p></li>
</ul>
<p><code>sf</code> 객체에 사용될 수 있는 <strong>tidyverse</strong> 로 <code>filter</code>, <code>select</code>, <code>group_by</code>, <code>ungroup</code>, <code>mutate</code>, <code>transmute</code>, <code>rowwise</code>, <code>rename</code>, <code>slice</code>, <code>summarise</code>, <code>distinct</code>, <code>gather</code>, <code>pivot_longer</code>, <code>spread</code>, <code>nest</code>, <code>unnest</code>, <code>unite</code>, <code>separate</code>, <code>separate_rows</code>, <code>sample_n</code>, 및 <code>sample_frac</code>등과 같은 것이 있다. 대부분의 함수는 <code>sf</code> 객체의 메타데이터를 관리하기만 할 뿐 지오메트리 정보를 건드리지 않는다. 사용자가 지오메트리를 제거하고자 할 경우, <code>st_drop_geometry</code>를 사용하거나 선택하기 전에 간단히 <code>tibble</code> 또는 <code>data.frame</code>으로 강제 변환(coerce)할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">nc</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">BIR74</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 3 × 1</span></span>
<span><span class="co">#   BIR74</span></span>
<span><span class="co">#   &lt;dbl&gt;</span></span>
<span><span class="co"># 1  1091</span></span>
<span><span class="co"># 2   487</span></span>
<span><span class="co"># 3  3188</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>sf</code> 객체에 대한 <code>summarise</code> 함수는 두 가지 특별한 아규먼트를 가지고 있다</p>
<ul>
<li><p><code>do_union</code> (기본값: TRUE): 그룹화된 지오메트리가 반환 시 유니언(합집합)되는지 여부를 결정하여, 유효한 지오메트리가 형성하도록 한다.</p></li>
<li><p><code>is_coverage</code> (기본값: FALSE): 그룹화된 지오메트리가 커버리지(겹침이 없는 경우)를 형성하는 경우, 이를 TRUE로 설정하면 유니언 과정이 빨라진다.</p></li>
</ul>
<p><code>distinct</code> 함수는 고유한 레코드를 선택하며, <code>st_equals</code> 함수는 지오메트리의 고유성을 평가한다.</p>
<p><code>filter</code> 함수는 일반적인 프레디케이트와 함께 사용할 수 있으며, 공간적 프레디케이트를 사용하고자 할 경우, 예를 들어 오렌지 카운티에서 50km 이내에 있는 모든 카운티를 선택하려면 다음과 같이 사용할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">orange</span> <span class="op">&lt;-</span> <span class="va">nc</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">NAME</span> <span class="op">==</span> <span class="st">"Orange"</span><span class="op">)</span></span>
<span><span class="va">wd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">st_is_within_distance</a></span><span class="op">(</span><span class="va">nc</span>, <span class="va">orange</span>, </span>
<span>                            <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html">set_units</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">km</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">o50</span> <span class="op">&lt;-</span> <span class="va">nc</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="va">wd</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">o50</span><span class="op">)</span></span>
<span><span class="co"># [1] 17</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(여기서 <code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter</a></code>를 사용하는 것은 베이스 R의 <code>filter</code> 함수와의 혼동을 피하기 위함이다.)</p>
<p>그림 7.3은 이 분석의 결과를 보여주며, 카운티 경계 주위에 버퍼도 추가되어 있다. 이 버퍼는 설명을 위한 것이며, 카운티를 선택하는 데 사용되지는 않았음을 주의하라.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-7-3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-7-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07_files/figure-html/fig-7-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" data-glightbox="description: .lightbox-desc-3"><img src="07_files/figure-html/fig-7-3-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-7-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;7.3: 오렌지 카운티(오렌지색), 반경 50km 내의 카운티(검은색), 오랜지 카운티 주변의 버퍼(갈색), 나머지 카운티(회색)
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="공간적-조인" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="공간적-조인">
<span class="header-section-number">7.2</span> 공간적 조인</h2>
<p>일반적인 조인(왼쪽, 오른쪽 또는 내부 조인)에서는 두 테이블 사이에서 하나 이상의 속성이 일치할 때 조인이 이루어진다. 공간적 조인도 이와 유사하지만, 레코드를 조인하는 기준은 속성의 일치가 아니라 공간적 프레디케이트이다. 이로 인해 공간적으로 일치하는 레코드를 정의하는 다양한 선택지가 있으며, 이는 3.2.2절에 나열된 바이너리 프레디케이트를 사용하여 결정할 수 있다. “왼쪽,” “오른쪽,” “내부,” 또는 “전체” 조인의 개념은 비공간 조인과 동일하게 유지되는데, 이 경우는 공간적 일치를 상정하지 않은 상태에서 레코드의 조인을 처리할 때이다.</p>
<p>공간적 조인을 실행할 때, 각 레코드에 여러 일치하는 레코드가 있을 수 있어 결과 테이블이 매우 커질 수 있다. 이 복잡성을 줄이는 방법으로, 일치하는 레코드 중에서 타깃 지오메트리와 가장 넓은 면적이 겹치는 레코드 하나를 선택하는 방식이 있다. 이 방법의 시각적 예시는 그림 7.4에 나타나 있으며, <code>st_join</code> 함수에서 <code>largest = TRUE</code> 아규먼트를 사용하여 이를 수행할 수 있다.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-7-4" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-7-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07_files/figure-html/fig-7-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" data-glightbox="description: .lightbox-desc-4"><img src="07_files/figure-html/fig-7-4-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-7-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;7.4: largest = TRUE 아규먼트를 적용한 st_join 함수의 예: 아래쪽 그림의 폴리곤과 가장 넓은 면적이 겹치는 위쪽 그림의 폴리곤 라벨이 아래쪽 폴리곤에 할당되어 있다.
</figcaption></figure>
</div>
</div>
</div>
<p>결과의 복잡성을 줄이는 또 다른 방법은 조인 후에 <code>aggregate</code> 함수를 사용하여 모든 일치하는 레코드를 결합함과 동시에 지오메트리도 병합하는 것이다. 이에 대한 자세한 내용은 5.4절을 참고하라.</p>
<section id="샘플링-그리딩-인터폴레이팅" class="level3" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="샘플링-그리딩-인터폴레이팅">
<span class="header-section-number">7.2.1</span> 샘플링, 그리딩, 인터폴레이팅</h3>
<p><code>sf</code> 패키지가 제공하는 유용한 함수 몇 가지를 소개하고자 한다. <code>st_sample</code> 함수는 타깃 지오메트리로부터 임의의 샘플링 포인트를 생성해 주는데, 타깃 지오메트리는 점, 선, 또는 폴리곤 등 다양할 수 있다. 샘플링 방식으로 완전 무작위 방식, 규칙적 방식, 또는 폴리곤의 경우 삼각형 방식이 선택될 수 있다. 11장에서 <code>spatstat</code> 패키지에서 제공하는 공간적 샘플링(또는 포인트 패턴 시뮬레이션) 방법들이 어떻게 <code>st_sample</code> 함수를 통해 이루어지는지 설명한다.</p>
<p><code>st_make_grid</code> 함수는 특정 영역 위에 정사각형, 직사각형, 또는 육각형의 그리드를 생성해준다. 옵션을 다르게 적용하면 그리드 자체가 아니라 그리드의 중심점 혹은 구석점을 생성해준다. 이 함수는 그림 7.4에서 직사각형 그리드를 생성하는 데 사용되었다.</p>
<p>함수 <code>st_interpolate_aw</code>는 5.3절에서 설명된 대로 공간적으로 내포적인 변수와 공간적으로 외연적인 변수를 새로운 영역으로 “인터폴레이션”하는 기능을 제공한다.</p>
</section></section><section id="타원-좌표" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="타원-좌표">
<span class="header-section-number">7.3</span> 타원 좌표</h2>
<p>비투영 데이터는 경위도로 표현된 타원체 좌표를 가진다. 4.1절에서 설명된 대로, 포인트간 “직선”은 최단 곡선 경로(“측지선”)이다. 기본적으로 <strong>sf</strong> 패키지는 <code>s2geometry</code> 라이브러리의 기하학적 연산을 사용하며, 이는 <strong>s2</strong> 패키지를 통해 이루어진다(Dunnington, Pebesma, and Rubak 2023). 예를 들어, 아래의 지점은 특정 폴리곤 <em>내부</em>에 존재한다(그림 7.5의 왼쪽 그림: 정사 도법).</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="st">"POINT(50 50.1)"</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="st">"OGC:CRS84"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">pt</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="st">"POLYGON((40 40, 60 40, 60 50, 40 50, 40 40))"</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="st">"OGC:CRS84"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">pol</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">st_intersects</a></span><span class="op">(</span><span class="va">pt</span>, <span class="va">pol</span><span class="op">)</span></span>
<span><span class="co"># Sparse geometry binary predicate list of length 1, where the</span></span>
<span><span class="co"># predicate was `intersects'</span></span>
<span><span class="co">#  1: 1</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-7-5" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-7-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07_files/figure-html/fig-7-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" data-glightbox="description: .lightbox-desc-5"><img src="07_files/figure-html/fig-7-5-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-7-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;7.5: 인터섹션의 결과는 측지선 혹은 대권호를 사용하느냐(왼쪽) 데카르트 좌표계를 사용하느냐에 따라 달라진다.
</figcaption></figure>
</div>
</div>
</div>
<p><strong>sf</strong> 패키지가 타원체 좌표를 마치 데카르트 좌표처럼 사용하도록 하려면, <strong>s2</strong> 사용을 비활성화하면 된다.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">old</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Spherical geometry (s2) switched off</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">st_intersects</a></span><span class="op">(</span><span class="va">pol</span>, <span class="va">pt</span><span class="op">)</span></span>
<span><span class="co"># although coordinates are longitude/latitude, st_intersects assumes</span></span>
<span><span class="co"># that they are planar</span></span>
<span><span class="co"># Sparse geometry binary predicate list of length 1, where the</span></span>
<span><span class="co"># predicate was `intersects'</span></span>
<span><span class="co">#  1: (empty)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="va">old</span><span class="op">)</span> <span class="co"># restore</span></span>
<span><span class="co"># Spherical geometry (s2) switched on</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이렇게 하면, 그림 7.5의 오른쪽 그림(정거원통 도법)처럼, 엠프티 인터섹션이 리턴된다. 타원체 좌표를 평면 좌표로 취급한다는 점이 경고 메시지에 명시되어 있다.</p>
<p>성능이나 레거시 구현과의 호환성 이유로 <strong>s2</strong> 사용을 비활성화할 수 있다. 데카르트 기하학을 위한 <strong>GEOS</strong> 라이브러리와 구체 기하학을 위한 <strong>s2geometry</strong> 라이브러리(그림 1.7)는 서로 다른 동기로 개발되었으며, <strong>sf</strong>를 통해 사용될 때 그 방식에서 몇 가지 차이가 있다.</p>
<ul>
<li><p>특정 오퍼레이션에서 속도차가 크게 날 수 있다.</p></li>
<li><p>특정 함수는 오로지 특정 라이브러리에만 존재한다(예를 들어 <code>st_relate</code> 함수는 <strong>GEOS</strong> 라이브러리에만 존재)</p></li>
<li><p>변환자(transformer)를 사용할 때, <strong>GEOS</strong>는 외부 폴리곤 링을 시계 방향으로 노드로 반환하며, 이를 반시계 방향으로 되돌리기 위해 <code>st_sfc(..., check_ring_dir = TRUE)</code>를 사용한다. 반면, <code>s2geometry</code>는 외부 폴리곤 링을 반시계 방향으로 반환한다.</p></li>
</ul></section><section id="stars-패키지" class="level2" data-number="7.4"><h2 data-number="7.4" class="anchored" data-anchor-id="stars-패키지">
<span class="header-section-number">7.4</span> stars 패키지</h2>
<p><code>sp</code> 패키지가 래스터 데이터에 대한 지원이라는 측면에서 정체되어 있는 동안, <code>raster</code> 패키지(Hijmans 2023a)가 지난 10여년 동안 래스터 분석을 위한 강력하고 유연하며 확장 가능한 패키지로서 지배적인 위치를 공고히 하였다. <code>raster</code> 패키지(및 그 후속인 <code>terra</code> 패키지(Hijmans 2023b))는 2D 규칙 래스터 또는 래스터 레이어 집합(“래스터 스택”)이라는 래스터 데이터 모델에 기반하고 있다. 이는 세상이 수많은 레이어로 구성되어 있고 개별 레이어는 특정한 주제를 반영하고 있다는 고전적인 정적 “GIS 뷰”와 일치한다. 그러나 오늘날의 많은 데이터는 동적이며, 시계열 래스터 또는 시계열 래스터 스택으로 제공된다. 기존의 래스터 스택은 이러한 동적 특성을 제대로 반영하지 못하며, 사용자늘 어떤 레이어가 무엇을 나타내는지를 기록하고 있어야만 한다.</p>
<p>또한, <code>raster</code> 패키지와 그 후속인 <code>terra</code> 패키지는 데이터 크기가 로컬 저장소(컴퓨터의 하드 드라이브)보다 크지 않을 때에만 훌륭한 전산 처리 능력을 발휘한다. 그러나 최근 데이터셋, 예를 들어 위성 이미지, 기후 모델 또는 기상 예보 데이터는 로컬 저장소의 용량으로는 더 이상 감당하기 어려운 수준에 도달했다(9장 참조). <code>spacetime</code> 패키지(Pebesma 2012, 2022)는 벡터 지오메트리 또는 래스터 그리드 셀의 시계열 분석을 어느 정도 다룰 수 있다. 하지만 더 높은 차원의 어레이나 메모리가 감당하기 어려운 정도의 크기를 가진 데이터셋은 여전히 다루기 어렵다.</p>
<p>여기서 우리는 래스터 및 벡터 데이터 큐브 분석을 위한 패키지로 <code>stars</code>를 소개한다. 이 패키지는 다음과 같은 기능을 제공한다.</p>
<ul>
<li><p>동적(시간 변화) 래스터 스택을 재현할 수 있다.</p></li>
<li><p>로컬 디스크의 크기에 한정되지 않는 확장 가능성을 목표로 한다.</p></li>
<li><p>GDAL 라이브러리의 래스터 기능과 강력한 통합을 제공한다.</p></li>
<li><p>규칙 그리드 외에도 회전, 전단, 직선, 곡선 래스터를 처리할 수 있다(그림 1.6 참조).</p></li>
<li><p>sf 패키지와의 긴밀한 통합을 제공한다.</p></li>
<li><p>비래스터(non-raster) 공간 차원을 가진 어레이 데이터(벡터 데이터 큐브)를 처리할 수 있다.</p></li>
<li><p>타이디버스 디자인 원리를 따른다.</p></li>
</ul>
<p>벡터 데이터 큐브에는 심플 피처의 시계열이나 출발지-목적지 매트릭스(그것의 시계열 포함)와 같은 공간 그래프 데이터가 포함된다. 공간적 벡터 및 래스터 데이터 큐브의 개념은 6장에서 설명되었다. 불규칙 시공간 관측치는 <code>sftime</code> 패키지(Teickner, Pebesma, and Graeler 2022)에서 제공하는 <code>sftime</code> 객체로 재현될 수 있으며, 이는 시간 열을 추가하는 방식으로 <code>sf</code> 객체를 확장한 것이다(13.3절 참조).</p>
<section id="래스터-데이터의-읽기와-쓰기" class="level3" data-number="7.4.1"><h3 data-number="7.4.1" class="anchored" data-anchor-id="래스터-데이터의-읽기와-쓰기">
<span class="header-section-number">7.4.1</span> 래스터 데이터의 읽기와 쓰기</h3>
<p>래스터 데이터는 일반적으로 파일을 불러온다. 우리는 브라질의 올린다 시에 대한 30m 해상도의 Landsat 7 데이터셋(밴드 1-5 및 7)을 사용한다. 패키지 <strong>stars</strong>에서 규칙 비회전 그리드에 대한 예제 GeoTIFF 파일을 읽을 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"tif/L7_ETMs.tif"</span>, package <span class="op">=</span> <span class="st">"stars"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/">stars</a></span><span class="op">)</span></span>
<span><span class="co"># Loading required package: abind</span></span>
<span><span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html">read_stars</a></span><span class="op">(</span><span class="va">tif</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># stars object with 3 dimensions and 1 attribute</span></span>
<span><span class="co"># attribute(s):</span></span>
<span><span class="co">#              Min. 1st Qu. Median Mean 3rd Qu. Max.</span></span>
<span><span class="co"># L7_ETMs.tif     1      54     69 68.9      86  255</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#      from  to  offset delta            refsys point x/y</span></span>
<span><span class="co"># x       1 349  288776  28.5 SIRGAS 2000 / ... FALSE [x]</span></span>
<span><span class="co"># y       1 352 9120761 -28.5 SIRGAS 2000 / ... FALSE [y]</span></span>
<span><span class="co"># band    1   6      NA    NA                NA    NA</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>여기서 우리는 오프셋, 셀 크기, 좌표참조계, 및 차원을 확인할 수 있다. 차원 테이블은 각 차원에 대해 다음과 같은 필드를 포함한다.</p>
<ul>
<li><p><code>from</code>: 시작 인덱스 값</p></li>
<li><p><code>to</code>: 종료 인덱스 값</p></li>
<li><p><code>offset</code>: 첫 번째 픽셀의 시작(모서리)에서의 차원 값</p></li>
<li><p><code>delta</code>: 셀 크기로 음의 delta 값은 디멘션 값이 감소할수록 필셀 인덱스 값이 증가한다는 것을 의미</p></li>
<li><p><code>refsys</code>: 참조계</p></li>
<li><p><code>point</code>: 셀 값이 포인트 서포트인지, 셀 서포트인지를 명시하는 논리 값</p></li>
<li><p><code>x/y</code>: 디멘션이 래스터의 x- 축과 관련되는지 y-축과 관련되는지를 나타내는 값</p></li>
</ul>
<p>여기에는 사용되지 않기 때문에 숨겨진 또 다른 필드인 <code>values</code>가 있다. 정규, 회전, 또는 전단 그리드와 같은 규칙적으로 이산화된 차원(예: 시간)의 경우, 오프셋과 델타는 NA가 아니다. 반면 불규칙한 경우에는 오프셋과 델타가 NA이며, <code>values</code> 속성은 다음 중 하나를 포함한다.</p>
<ul>
<li><p>값 또는 구간의 시퀀스: 직선 공간 래스터 또는 불규칙 시간 차원의 경우</p></li>
<li><p>공간 차원과 연결된 지오메트리: 벡터 데이트 큐브의 경우</p></li>
<li><p>각 래스터 셀에 대한 좌표값이 포함된 매트릭스: 곡선 래스터의 경우</p></li>
<li><p>차원 값과 연결된 밴드 이름 또는 레이블: 이산 디멘션의 경우</p></li>
</ul>
<p><code>stars</code> 클래스의 객체 <code>r</code>은 길이가 1인 간단한 리스트로 구성되어 있으며, 3차원 어레이를 포함한다.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="co"># [1] 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">r</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># [1] "array"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">r</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#    x    y band </span></span>
<span><span class="co">#  349  352    6</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>또한, 이 객체는 어레이 차원이 무엇을 나타내는지 알기 위해 필요한 모든 메타데이터를 포함한 디멘션 테이블을 속성으로 가지고 있다. 이는 다음을 통해 얻어진다.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_dimensions.html">st_dimensions</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>어레이의 공간적 범위에 대한 정보를 다음과 같이 얻을 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="co">#    xmin    ymin    xmax    ymax </span></span>
<span><span class="co">#  288776 9110729  298723 9120761</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>write_stars</code> 함수를 통해 래스터 데이터를 로컬 디스크에 저장할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/write_stars.html">write_stars</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">tf</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>파일 확장자를 통해 데이터 형식(이 경우, GeoTIFF)이 지정된다. 단순 피처와 마찬가지로 읽기 및 쓰기 작업은 GDAL 라이브러리를 사용하며, 래스터 데이터에 사용할 수 있는 드라이버 목록은 다음을 통해 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_drivers.html">st_drivers</a></span><span class="op">(</span><span class="st">"raster"</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="stars-데이터-큐브로부터-일부분-골라내기" class="level3" data-number="7.4.2"><h3 data-number="7.4.2" class="anchored" data-anchor-id="stars-데이터-큐브로부터-일부분-골라내기">
<span class="header-section-number">7.4.2</span> <code>stars</code> 데이터 큐브로부터 일부분 골라내기</h3>
<p>데이터 큐브는 <code>[</code> 연산자를 사용하거나 타이디버스 동사를 사용하여 부분 집합을 만들 수 있다. 첫 번째 옵션인 <code>[</code>를 사용하는 방식은 다음의 아규먼트를 쉼표의 구분과 함께 순서대로 지정하는 것이다.</p>
<ul>
<li><p>속성(이름, 인덱스, 또는 논리 벡터)</p></li>
<li><p>차원</p></li>
</ul>
<p>예를 들어, <code>r[1:2, 101:200,, 5:10]</code>는 <code>r</code>에서 속성 1-2를 선택하고, 디멘션 1에 대해 인덱스 101-200, 차원 3에 대해 인덱스 5-10을 선택함을 의미한다. 차원 2를 통한 선택은 이루어지지 않는다. 속성의 경우, 속성 이름, 인덱스 또는 논리 벡터를 사용할 수 있다. 차원의 경우에는 논리 벡터가 지원되지 않는다. 불연속 범위 선택은 규칙 시퀀스일 때만 지원된다. 기본적으로 <code>drop</code>은 <code>FALSE</code>로 설정되어 있으며, <code>TRUE</code>로 설정하면 단일 값을 가진 차원은 모두 제거된다.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">r</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">250</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#    x    y band </span></span>
<span><span class="co">#  100   50    1</span></span>
<span><span class="va">r</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">250</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fl">4</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#   x   y </span></span>
<span><span class="co"># 100  50</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>특정 범위의 차원 <em>값</em>을 선택하기 위해 <code>filter</code> 함수를 사용할 수 있는데, 이는 <code>dplyr</code> 패키지를 우선적으로 로드해야 한다.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">289000</span>, <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">290000</span><span class="op">)</span></span>
<span><span class="co"># stars object with 3 dimensions and 1 attribute</span></span>
<span><span class="co"># attribute(s):</span></span>
<span><span class="co">#              Min. 1st Qu. Median Mean 3rd Qu. Max.</span></span>
<span><span class="co"># L7_ETMs.tif     5      51     63 64.3      75  242</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#      from  to  offset delta            refsys point x/y</span></span>
<span><span class="co"># x       1  35  289004  28.5 SIRGAS 2000 / ... FALSE [x]</span></span>
<span><span class="co"># y       1 352 9120761 -28.5 SIRGAS 2000 / ... FALSE [y]</span></span>
<span><span class="co"># band    1   6       1     1                NA    NA</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이는 차원의 오프셋을 변경한다. 특정 큐브 슬라이스는 <code>slice</code> 함수를 사용하여 얻을 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">band</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># stars object with 2 dimensions and 1 attribute</span></span>
<span><span class="co"># attribute(s):</span></span>
<span><span class="co">#              Min. 1st Qu. Median Mean 3rd Qu. Max.</span></span>
<span><span class="co"># L7_ETMs.tif    21      49     63 64.4      77  255</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#   from  to  offset delta            refsys point x/y</span></span>
<span><span class="co"># x    1 349  288776  28.5 SIRGAS 2000 / ... FALSE [x]</span></span>
<span><span class="co"># y    1 352 9120761 -28.5 SIRGAS 2000 / ... FALSE [y]</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이는 단일 차원 <code>band</code>를 제거한다. <code>mutate</code> 함수는 <code>stars</code> 객체에서 기존 어레이를 기반으로 새로운 어레이를 추가하는 데 사용되며, <code>transmute</code>는 여기에 덧붙여 기존 어레이를 제거한다.</p>
</section><section id="잘라내기" class="level3" data-number="7.4.3"><h3 data-number="7.4.3" class="anchored" data-anchor-id="잘라내기">
<span class="header-section-number">7.4.3</span> 잘라내기</h3>
<p>부분 집합을 생성하는 또 다른 방법에 <code>sf</code>, <code>sfc</code> 또는 <code>bbox</code> 클래스의 공간 객체를 사용하는 방법이 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_centroid</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_buffer</a></span><span class="op">(</span><span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html">set_units</a></span><span class="op">(</span><span class="fl">500</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">r</span><span class="op">[</span><span class="va">b</span><span class="op">]</span></span>
<span><span class="co"># stars object with 3 dimensions and 1 attribute</span></span>
<span><span class="co"># attribute(s):</span></span>
<span><span class="co">#              Min. 1st Qu. Median Mean 3rd Qu. Max. NA's</span></span>
<span><span class="co"># L7_ETMs.tif    22      54     66 67.7    78.2  174 2184</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#      from  to  offset delta            refsys point x/y</span></span>
<span><span class="co"># x     157 193  288776  28.5 SIRGAS 2000 / ... FALSE [x]</span></span>
<span><span class="co"># y     159 194 9120761 -28.5 SIRGAS 2000 / ... FALSE [y]</span></span>
<span><span class="co"># band    1   6      NA    NA                NA    NA</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>예를 들어, 해당 지역에 대한 직경 500m의 원형 중심부를 추출할 수 있는데, 그림 7.6에는 첫 번째 밴드에 적용한 결과가 나타나 있다.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-7-6" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-7-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07_files/figure-html/fig-7-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" data-glightbox="description: .lightbox-desc-6"><img src="07_files/figure-html/fig-7-6-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-7-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;7.6: Landsat 7 (band 1) 이미지의 원형 중심부
</figcaption></figure>
</div>
</div>
</div>
<p>원형 공간 객체의 외부에 존재하는 픽셀에는 NA 값이 할당되는 것을 볼 수 있다. 이 원형 객체는 여전히 <code>r</code>의 <code>offset</code>과 <code>delta</code> 값에 대한 차원 인덱스를 가지고 있다. 다음과 같은 방식으로 <code>offset</code> 값을 재설정할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">r</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_normalize.html">st_normalize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_dimensions.html">st_dimensions</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#      from to  offset delta            refsys point x/y</span></span>
<span><span class="co"># x       1 37  293222  28.5 SIRGAS 2000 / ... FALSE [x]</span></span>
<span><span class="co"># y       1 36 9116258 -28.5 SIRGAS 2000 / ... FALSE [y]</span></span>
<span><span class="co"># band    1  6      NA    NA                NA    NA</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>기본적으로, 결과 래스터는 선택 객체의 범위로 잘린다. 입력 객체와 동일한 차원을 가진 객체는 다음과 같은 방식으로 얻을 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">r</span><span class="op">[</span><span class="va">b</span>, crop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span><span class="co"># stars object with 3 dimensions and 1 attribute</span></span>
<span><span class="co"># attribute(s):</span></span>
<span><span class="co">#              Min. 1st Qu. Median Mean 3rd Qu. Max.   NA's</span></span>
<span><span class="co"># L7_ETMs.tif    22      54     66 67.7    78.2  174 731280</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#      from  to  offset delta            refsys point x/y</span></span>
<span><span class="co"># x       1 349  288776  28.5 SIRGAS 2000 / ... FALSE [x]</span></span>
<span><span class="co"># y       1 352 9120761 -28.5 SIRGAS 2000 / ... FALSE [y]</span></span>
<span><span class="co"># band    1   6      NA    NA                NA    NA</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>stars</code> 객체의 잘라내기는 <code>st_crop</code> 함수를 사용하여 직접 수행할 수도 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">b</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="stars-객체의-차원재부여-및-결합" class="level3" data-number="7.4.4"><h3 data-number="7.4.4" class="anchored" data-anchor-id="stars-객체의-차원재부여-및-결합">
<span class="header-section-number">7.4.4</span> stars 객체의 차원재부여 및 결합</h3>
<p><code>stars</code> 패키지는 다양한 어레이 조작을 수행하기 위해 패키지 <code>abind</code> (Plate and Heiberger 2016)를 사용한다. 한 예로 어레이를 순열하여 전치하는 <code>aperm</code> 함수이다.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/aperm.html">aperm</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># stars object with 3 dimensions and 1 attribute</span></span>
<span><span class="co"># attribute(s):</span></span>
<span><span class="co">#              Min. 1st Qu. Median Mean 3rd Qu. Max.</span></span>
<span><span class="co"># L7_ETMs.tif     1      54     69 68.9      86  255</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#      from  to  offset delta            refsys point x/y</span></span>
<span><span class="co"># band    1   6      NA    NA                NA    NA    </span></span>
<span><span class="co"># x       1 349  288776  28.5 SIRGAS 2000 / ... FALSE [x]</span></span>
<span><span class="co"># y       1 352 9120761 -28.5 SIRGAS 2000 / ... FALSE [y]</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>stars</code> 객체에 대한 메서드가 제공되며, 결과 객체의 차원 순서를 순열한다.</p>
<p>속성과 차원을 교환할 수 있으며, 이는 <code>split</code>과 <code>merge</code>를 사용하여 수행된다.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># stars object with 2 dimensions and 6 attributes</span></span>
<span><span class="co"># attribute(s):</span></span>
<span><span class="co">#     Min. 1st Qu. Median Mean 3rd Qu. Max.</span></span>
<span><span class="co"># X1    47      67     78 79.1      89  255</span></span>
<span><span class="co"># X2    32      55     66 67.6      79  255</span></span>
<span><span class="co"># X3    21      49     63 64.4      77  255</span></span>
<span><span class="co"># X4     9      52     63 59.2      75  255</span></span>
<span><span class="co"># X5     1      63     89 83.2     112  255</span></span>
<span><span class="co"># X6     1      32     60 60.0      88  255</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#   from  to  offset delta            refsys point x/y</span></span>
<span><span class="co"># x    1 349  288776  28.5 SIRGAS 2000 / ... FALSE [x]</span></span>
<span><span class="co"># y    1 352 9120761 -28.5 SIRGAS 2000 / ... FALSE [y]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">rs</span>, name <span class="op">=</span> <span class="st">"band"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="st">"L7_ETMs"</span><span class="op">)</span></span>
<span><span class="co"># stars object with 3 dimensions and 1 attribute</span></span>
<span><span class="co"># attribute(s):</span></span>
<span><span class="co">#          Min. 1st Qu. Median Mean 3rd Qu. Max.</span></span>
<span><span class="co"># L7_ETMs     1      54     69 68.9      86  255</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#      from  to  offset delta            refsys point    values x/y</span></span>
<span><span class="co"># x       1 349  288776  28.5 SIRGAS 2000 / ... FALSE      NULL [x]</span></span>
<span><span class="co"># y       1 352 9120761 -28.5 SIRGAS 2000 / ... FALSE      NULL [y]</span></span>
<span><span class="co"># band    1   6      NA    NA                NA    NA X1,...,X6</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>split</code> 함수는 밴드 차원을 2차원 어레이의 여섯 개 속성에 분배하며, <code>merge</code> 함수는 거꾸로 수행한다. <code>st_redimension</code> 함수는 단일 어레이 차원을 두 개의 새로운 차원으로 분할하는 것과 같은 보다 일반적인 작업에 사용된다.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/redimension.html">st_redimension</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">349</span>, y <span class="op">=</span> <span class="fl">352</span>, b1 <span class="op">=</span> <span class="fl">3</span>, b2 <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># stars object with 4 dimensions and 1 attribute</span></span>
<span><span class="co"># attribute(s):</span></span>
<span><span class="co">#              Min. 1st Qu. Median Mean 3rd Qu. Max.</span></span>
<span><span class="co"># L7_ETMs.tif     1      54     69 68.9      86  255</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#    from  to  offset delta            refsys point x/y</span></span>
<span><span class="co"># x     1 349  288776  28.5 SIRGAS 2000 / ... FALSE [x]</span></span>
<span><span class="co"># y     1 352 9120761 -28.5 SIRGAS 2000 / ... FALSE [y]</span></span>
<span><span class="co"># b1    1   3      NA    NA                NA    NA    </span></span>
<span><span class="co"># b2    1   2      NA    NA                NA    NA</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>동일한 차원을 가진 여러 개의 <code>stars</code> 객체는 <code>c</code>를 사용하여 결합할 수 있다. 결합된 어레이는 추가적인 속성으로 취급하는 것이 디폴트 설정이지만, <code>along</code> 아규먼트를 지정하면 어레이를 새로운 차선을 따라 병합할 수도 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">r</span>, along <span class="op">=</span> <span class="st">"new_dim"</span><span class="op">)</span></span>
<span><span class="co"># stars object with 4 dimensions and 1 attribute</span></span>
<span><span class="co"># attribute(s), summary of first 1e+05 cells:</span></span>
<span><span class="co">#              Min. 1st Qu. Median Mean 3rd Qu. Max.</span></span>
<span><span class="co"># L7_ETMs.tif    47      65     76 77.3      87  255</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#         from  to  offset delta            refsys point x/y</span></span>
<span><span class="co"># x          1 349  288776  28.5 SIRGAS 2000 / ... FALSE [x]</span></span>
<span><span class="co"># y          1 352 9120761 -28.5 SIRGAS 2000 / ... FALSE [y]</span></span>
<span><span class="co"># band       1   6      NA    NA                NA    NA    </span></span>
<span><span class="co"># new_dim    1   2      NA    NA                NA    NA</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이의 사용 예시는 7.5.2절에서 설명된다.</p>
</section><section id="포인트-샘플-추출하기-애그리게이팅하기" class="level3" data-number="7.4.5"><h3 data-number="7.4.5" class="anchored" data-anchor-id="포인트-샘플-추출하기-애그리게이팅하기">
<span class="header-section-number">7.4.5</span> 포인트 샘플 추출하기, 애그리게이팅하기</h3>
<p>래스터 데이터 큐브 분석의 매우 일반적인 사용 사례는 특정 위치에서 값을 추출하거나 특정 지오메트리에 대해 집계값을 계산하는 것이다. <code>st_extract</code> 함수는 포인트 값을 추출한다. 우리는 <code>r</code> 객체의 바운딩 박스 내의 몇 개의 무작위로 샘플링 포인트에 대해 이 오퍼레이션을 수행할 것이다.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">115517</span><span class="op">)</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_sample.html">st_sample</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_extract.html">st_extract</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">pts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># stars object with 2 dimensions and 1 attribute</span></span>
<span><span class="co"># attribute(s):</span></span>
<span><span class="co">#              Min. 1st Qu. Median Mean 3rd Qu. Max.</span></span>
<span><span class="co"># L7_ETMs.tif    12    41.8     63   61    80.5  145</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#          from to            refsys point</span></span>
<span><span class="co"># geometry    1 20 SIRGAS 2000 / ...  TRUE</span></span>
<span><span class="co"># band        1  6                NA    NA</span></span>
<span><span class="co">#                                           values</span></span>
<span><span class="co"># geometry POINT (293002 ...,...,POINT (290941 ...</span></span>
<span><span class="co"># band                                        NULL</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이것은 20개의 포인트와 6개의 밴드를 가진 벡터 데이터 큐브를 생성한다(시드를 설정하게 되면, 반복 실행에서 동일한 샘플의 사용이 보장된다. 따라서 포인트의 무작위 생성을 재실행하고자 하는 경우는 시드를 설정해서는 안된다).</p>
<p>데이터 큐브에서 정보를 추출하는 또 다른 방법은 집계값을 산출하는 것이다. 이를 수행하는 한 가지 방법은 공간 폴리곤 또는 라인에 의거해 값을 공간적으로 집계하는 것이다(6.4절 참조). 예를 들어, 그림 1.4(d)에 표시된 세 개의 원 각각에 대해 여섯 개 밴드의 최대 픽셀 값을 계산할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">circles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_sample.html">st_sample</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_buffer</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">circles</span>, <span class="va">max</span><span class="op">)</span></span>
<span><span class="co"># stars object with 2 dimensions and 1 attribute</span></span>
<span><span class="co"># attribute(s):</span></span>
<span><span class="co">#              Min. 1st Qu. Median Mean 3rd Qu. Max.</span></span>
<span><span class="co"># L7_ETMs.tif    73    94.2    117  121     142  205</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#          from to            refsys point</span></span>
<span><span class="co"># geometry    1  3 SIRGAS 2000 / ... FALSE</span></span>
<span><span class="co"># band        1  6                NA    NA</span></span>
<span><span class="co">#                                           values</span></span>
<span><span class="co"># geometry POLYGON ((2913...,...,POLYGON ((2921...</span></span>
<span><span class="co"># band                                        NULL</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이는 세 개의 지오메트리와 여섯 개의 밴드를 가진 (벡터) 데이터 큐브를 생성한다. 시간 차원에 대한 집계값의 산출은 <code>aggregate</code> 함수의 두 번째 아규먼트로 시간 변수를 설정하여 수행된다. 시간 변수에 다음과 같은 것이 있을 수 있다.</p>
<ul>
<li><p>시간 간격의 시작을 나타내는 타임 스탬프의 집합</p></li>
<li><p><code>make_intervals</code> 함수로 정의된 시간 간격 집합</p></li>
<li><p>“주”, “5일” 또는 “년”과 같은 시간 기간</p></li>
</ul></section><section id="예측-모델" class="level3" data-number="7.4.6"><h3 data-number="7.4.6" class="anchored" data-anchor-id="예측-모델">
<span class="header-section-number">7.4.6</span> 예측 모델</h3>
<p>R에서의 일반적인 모델 예측 워크플로우는 다음과 같다.</p>
<ul>
<li><p>응답 변수와 예측 변수(공변량)가 포함된 <code>data.frame</code>의 사용</p></li>
<li><p><code>data.frame</code>을 기반으로 모델 객체를 생성</p></li>
<li><p>모델 객체와 대상 예측 변수 값이 포함된 <code>data.frame</code>을 사용하여 <code>predict</code>를 호출</p></li>
</ul>
<p><code>stars</code> 패키지는 <code>stars</code> 객체에 대한 <code>predict</code> 메서드를 제공하며, 이는 본질적으로 위의 마지막 단계를 수행하는데, data.frame을 생성하고, <code>predict</code> 메서드를 호출한 후, 예측 값으로 <code>stars</code> 객체를 재구성한다.</p>
<p>이 과정을 설명하기 위해 Landsat 데이터셋에 위에서 추출한 샘플 포인트를 적용해 육지를 바다에서 분리하는 간단한 이진 클래스 예제를 사용할 것이다. 결과는 그림 7.7에 나타나 있다.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-7-7" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-7-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07_files/figure-html/fig-7-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" data-glightbox="description: .lightbox-desc-7"><img src="07_files/figure-html/fig-7-7-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-7-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;7.7: 트레이닝 데이터로 사용되는 무작위 샘플 포인트: 빨간색은 해양부이고 노란색을 육지부이다.
</figcaption></figure>
</div>
</div>
</div>
<p>이 그림에서 포인트 8, 14, 15, 18 및 19는 수부에 위치하고 있으며, 나머지는 육지부에 있다는 것을 “육안”으로 확인할 수 있다. 선형 판별(“최대 우도”) 분류기를 사용하여, 우리는 그림 7.8에 나타난 모델 예측 결과를 얻을 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="va">trn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_extract.html">st_extract</a></span><span class="op">(</span><span class="va">rs</span>, <span class="va">pts</span><span class="op">)</span></span>
<span><span class="va">trn</span><span class="op">$</span><span class="va">cls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"land"</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">trn</span><span class="op">$</span><span class="va">cls</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">18</span>, <span class="fl">19</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"water"</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lda.html">lda</a></span><span class="op">(</span><span class="va">cls</span> <span class="op">~</span> <span class="va">.</span>, <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">trn</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">rs</span>, <span class="va">model</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>여기서 우리는 <code>MASS::</code> 접두사를 사용하여 <strong>MASS</strong> 패키지를 로드하지 않았으며, 이는 <code>dplyr</code>의 <code>select</code> 함수를 가리는 것을 방지하기 위함이다. <code>split</code> 단계는 밴드 차원을 속성으로 변환하여 예측 변수로 투입하기 위해 필요한 단계이다.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-7-8" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-7-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07_files/figure-html/fig-7-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" data-glightbox="description: .lightbox-desc-8"><img src="07_files/figure-html/fig-7-8-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-7-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;7.8: 육지부/수부 구분을 위한 선형 판별 분류기로 그림 7.7의 트레이닝 데이터에 기반한 결과임.
</figcaption></figure>
</div>
</div>
</div>
<p>우리는 또한 그림 7.8에 플로팅된 레이어가 클래스 레이블을 가진 범주형 변수임을 알 수 있다.</p>
</section><section id="래스터-데이터-플로팅" class="level3" data-number="7.4.7"><h3 data-number="7.4.7" class="anchored" data-anchor-id="래스터-데이터-플로팅">
<span class="header-section-number">7.4.7</span> 래스터 데이터 플로팅</h3>
</section><section id="래스터-데이터-분석하기" class="level3" data-number="7.4.8"><h3 data-number="7.4.8" class="anchored" data-anchor-id="래스터-데이터-분석하기">
<span class="header-section-number">7.4.8</span> 래스터 데이터 분석하기</h3>
</section><section id="곡선-래스터" class="level3" data-number="7.4.9"><h3 data-number="7.4.9" class="anchored" data-anchor-id="곡선-래스터">
<span class="header-section-number">7.4.9</span> 곡선 래스터</h3>
</section><section id="goal-utils" class="level3" data-number="7.4.10"><h3 data-number="7.4.10" class="anchored" data-anchor-id="goal-utils">
<span class="header-section-number">7.4.10</span> GOAL utils</h3>
</section></section><section id="벡터-데이터-큐브-사례" class="level2" data-number="7.5"><h2 data-number="7.5" class="anchored" data-anchor-id="벡터-데이터-큐브-사례">
<span class="header-section-number">7.5</span> 벡터 데이터 큐브 사례</h2>
<section id="사례-대기질-시계열-애그리게이팅하기" class="level3" data-number="7.5.1"><h3 data-number="7.5.1" class="anchored" data-anchor-id="사례-대기질-시계열-애그리게이팅하기">
<span class="header-section-number">7.5.1</span> 사례: 대기질 시계열 애그리게이팅하기</h3>
</section><section id="사례-브리스톨-출발지-도착지-데이터-큐브" class="level3" data-number="7.5.2"><h3 data-number="7.5.2" class="anchored" data-anchor-id="사례-브리스톨-출발지-도착지-데이터-큐브">
<span class="header-section-number">7.5.2</span> 사례: 브리스톨 출발지-도착지 데이터 큐브</h3>
</section><section id="타이디-어레이-데이터" class="level3" data-number="7.5.3"><h3 data-number="7.5.3" class="anchored" data-anchor-id="타이디-어레이-데이터">
<span class="header-section-number">7.5.3</span> 타이디 어레이 데이터</h3>
</section><section id="벡터-데이터-큐브를-위한-파일-포멧" class="level3" data-number="7.5.4"><h3 data-number="7.5.4" class="anchored" data-anchor-id="벡터-데이터-큐브를-위한-파일-포멧">
<span class="header-section-number">7.5.4</span> 벡터 데이터 큐브를 위한 파일 포멧</h3>
</section></section><section id="래스터-투-벡터와-벡터-투-래스터" class="level2" data-number="7.6"><h2 data-number="7.6" class="anchored" data-anchor-id="래스터-투-벡터와-벡터-투-래스터">
<span class="header-section-number">7.6</span> 래스터-투-벡터와 벡터-투-래스터</h2>
<section id="벡터-투-래스터" class="level3" data-number="7.6.1"><h3 data-number="7.6.1" class="anchored" data-anchor-id="벡터-투-래스터">
<span class="header-section-number">7.6.1</span> 벡터-투-래스터</h3>
</section></section><section id="좌표변환-및-좌표전환" class="level2" data-number="7.7"><h2 data-number="7.7" class="anchored" data-anchor-id="좌표변환-및-좌표전환">
<span class="header-section-number">7.7</span> 좌표변환 및 좌표전환</h2>
<section id="데이텀-그리드-proj.db-cdn.proj.org.-로컬-캐쉬" class="level3" data-number="7.7.1"><h3 data-number="7.7.1" class="anchored" data-anchor-id="데이텀-그리드-proj.db-cdn.proj.org.-로컬-캐쉬">
<span class="header-section-number">7.7.1</span> 데이텀 그리드, proj.db, cdn.proj.org. 로컬 캐쉬</h3>
</section><section id="변환-파이프라인" class="level3" data-number="7.7.2"><h3 data-number="7.7.2" class="anchored" data-anchor-id="변환-파이프라인">
<span class="header-section-number">7.7.2</span> 변환 파이프라인</h3>
</section><section id="축-순서와-방향" class="level3" data-number="7.7.3"><h3 data-number="7.7.3" class="anchored" data-anchor-id="축-순서와-방향">
<span class="header-section-number">7.7.3</span> 축 순서와 방향</h3>
</section></section><section id="래스터-변환-및-워프" class="level2" data-number="7.8"><h2 data-number="7.8" class="anchored" data-anchor-id="래스터-변환-및-워프">
<span class="header-section-number">7.8</span> 래스터 변환 및 워프</h2>
</section><section id="연습문제" class="level2" data-number="7.9"><h2 data-number="7.9" class="anchored" data-anchor-id="연습문제">
<span class="header-section-number">7.9</span> 연습문제</h2>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">그림&nbsp;7.1: sf 객체의 구조</span>
<span class="glightbox-desc lightbox-desc-2">그림&nbsp;7.2: 노스케롤라이나의 첫 7개의 카운티</span>
<span class="glightbox-desc lightbox-desc-3">그림&nbsp;7.3: 오렌지 카운티(오렌지색), 반경 50km 내의 카운티(검은색), 오랜지 카운티 주변의 버퍼(갈색), 나머지 카운티(회색)</span>
<span class="glightbox-desc lightbox-desc-4">그림&nbsp;7.4: largest = TRUE 아규먼트를 적용한 st_join 함수의 예: 아래쪽 그림의 폴리곤과 가장 넓은 면적이 겹치는 위쪽 그림의 폴리곤 라벨이 아래쪽 폴리곤에 할당되어 있다.</span>
<span class="glightbox-desc lightbox-desc-5">그림&nbsp;7.5: 인터섹션의 결과는 측지선 혹은 대권호를 사용하느냐(왼쪽) 데카르트 좌표계를 사용하느냐에 따라 달라진다.</span>
<span class="glightbox-desc lightbox-desc-6">그림&nbsp;7.6: Landsat 7 (band 1) 이미지의 원형 중심부</span>
<span class="glightbox-desc lightbox-desc-7">그림&nbsp;7.7: 트레이닝 데이터로 사용되는 무작위 샘플 포인트: 빨간색은 해양부이고 노란색을 육지부이다.</span>
<span class="glightbox-desc lightbox-desc-8">그림&nbsp;7.8: 육지부/수부 구분을 위한 선형 판별 분류기로 그림 7.7의 트레이닝 데이터에 기반한 결과임.</span>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./part_2.html" class="pagination-link  aria-label=" r="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">공간데이터사이언스와 R</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08.html" class="pagination-link" aria-label="<span class='chapter-number'>8</span>&nbsp; <span class='chapter-title'>공간데이터의 시각화</span>">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">공간데이터의 시각화</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/sangillee66/book_sds_trans/issues/new" class="toc-action"><i class="bi bi-github"></i>이슈 보고</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"descPosition":"bottom","selector":".lightbox","loop":false,"openEffect":"zoom","closeEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>


</body></html>