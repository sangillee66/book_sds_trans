<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>공간데이터사이언스 개론 - 8&nbsp; 공간데이터의 플로팅</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09.html" rel="next">
<link href="./07.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title"><span id="sec-plotting" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">공간데이터의 플로팅</span></span></h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">공간데이터사이언스 개론</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/sangillee66/book_sds_trans" title="소스 코드" class="quarto-navigation-tool px-1" aria-label="소스 코드"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="검색"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">서장</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">공간데이터</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">시작하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">좌표계</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">지오메트리</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">구체 지오메트리</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">속성과 서포트</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">데이터 큐브</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">공간데이터사이언스와 R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">sf와 stars 패키지</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">공간데이터의 플로팅</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">대규모 데이터와 클라우드 네이티브</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">공간통계분석과 공간모델링</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">공간데이터의 통계적 모형화</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">포인트 패턴 분석</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">공간적 인터폴레이션</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">다변량 및 시공간 지구통계학</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">근접성과 에어리어 데이터</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">공간적 자기상관 측도</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">공간적 회귀분석</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">공간계량경제학적 모형</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">부록</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">예전 R 공간 패키지</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">R 기초</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">목차</h2>
   
  <ul>
<li>
<a href="#sec-every" id="toc-sec-every" class="nav-link active" data-scroll-target="#sec-every"><span class="header-section-number">8.1</span> 모든 지도는 투영법을 가지고 있다.</a>
  <ul class="collapse">
<li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%97%90-%EB%A7%9E%EB%8A%94-%ED%88%AC%EC%98%81%EB%B2%95-%EA%B3%A0%EB%A5%B4%EA%B8%B0" id="toc-데이터에-맞는-투영법-고르기" class="nav-link" data-scroll-target="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%97%90-%EB%A7%9E%EB%8A%94-%ED%88%AC%EC%98%81%EB%B2%95-%EA%B3%A0%EB%A5%B4%EA%B8%B0"><span class="header-section-number">8.1.1</span> 데이터에 맞는 투영법 고르기</a></li>
  </ul>
</li>
  <li>
<a href="#%ED%8F%AC%EC%9D%B8%ED%8A%B8-%EB%9D%BC%EC%9D%B8-%ED%8F%B4%EB%A6%AC%EA%B3%A4-%EA%B7%B8%EB%A6%AC%EB%93%9C-%EC%85%80-%ED%94%8C%EB%A1%9C%ED%8C%85" id="toc-포인트-라인-폴리곤-그리드-셀-플로팅" class="nav-link" data-scroll-target="#%ED%8F%AC%EC%9D%B8%ED%8A%B8-%EB%9D%BC%EC%9D%B8-%ED%8F%B4%EB%A6%AC%EA%B3%A4-%EA%B7%B8%EB%A6%AC%EB%93%9C-%EC%85%80-%ED%94%8C%EB%A1%9C%ED%8C%85"><span class="header-section-number">8.2</span> 포인트, 라인, 폴리곤, 그리드 셀 플로팅</a>
  <ul class="collapse">
<li><a href="#%EC%BB%AC%EB%9F%AC" id="toc-컬러" class="nav-link" data-scroll-target="#%EC%BB%AC%EB%9F%AC"><span class="header-section-number">8.2.1</span> 컬러</a></li>
  <li><a href="#%EC%BB%AC%EB%9F%AC-%EB%8B%A8%EC%A0%88%EA%B0%92-classint" id="toc-컬러-단절값-classint" class="nav-link" data-scroll-target="#%EC%BB%AC%EB%9F%AC-%EB%8B%A8%EC%A0%88%EA%B0%92-classint"><span class="header-section-number">8.2.2</span> 컬러 단절값: <code>classInt</code></a></li>
  <li><a href="#%EA%B7%B8%EB%9E%98%ED%8B%B0%ED%81%98-%EB%B0%8F-%EA%B4%80%EB%A0%A8-%EC%9A%94%EC%86%8C" id="toc-그래티큘-및-관련-요소" class="nav-link" data-scroll-target="#%EA%B7%B8%EB%9E%98%ED%8B%B0%ED%81%98-%EB%B0%8F-%EA%B4%80%EB%A0%A8-%EC%9A%94%EC%86%8C"><span class="header-section-number">8.2.3</span> 그래티큘 및 관련 요소</a></li>
  </ul>
</li>
  <li>
<a href="#%EB%B2%A0%EC%9D%B4%EC%8A%A4-plot" id="toc-베이스-plot" class="nav-link" data-scroll-target="#%EB%B2%A0%EC%9D%B4%EC%8A%A4-plot"><span class="header-section-number">8.3</span> 베이스 <code>plot</code></a>
  <ul class="collapse">
<li><a href="#%ED%94%8C%EB%A1%AF%EC%97%90-%EB%B2%94%EB%A1%80-%EC%B2%A8%EA%B0%80%ED%95%98%EA%B8%B0" id="toc-플롯에-범례-첨가하기" class="nav-link" data-scroll-target="#%ED%94%8C%EB%A1%AF%EC%97%90-%EB%B2%94%EB%A1%80-%EC%B2%A8%EA%B0%80%ED%95%98%EA%B8%B0"><span class="header-section-number">8.3.1</span> 플롯에 범례 첨가하기</a></li>
  <li><a href="#%EB%B2%A0%EC%9D%B4%EC%8A%A4-%ED%94%8C%EB%A1%AF%EC%9D%98-%ED%88%AC%EC%98%81%EB%B2%95" id="toc-베이스-플롯의-투영법" class="nav-link" data-scroll-target="#%EB%B2%A0%EC%9D%B4%EC%8A%A4-%ED%94%8C%EB%A1%AF%EC%9D%98-%ED%88%AC%EC%98%81%EB%B2%95"><span class="header-section-number">8.3.2</span> 베이스 플롯의 투영법</a></li>
  <li><a href="#%EC%BB%AC%EB%9F%AC%EC%99%80-%EC%BB%AC%EB%9F%AC-%EB%8B%A8%EC%A0%88%EA%B0%92" id="toc-컬러와-컬러-단절값" class="nav-link" data-scroll-target="#%EC%BB%AC%EB%9F%AC%EC%99%80-%EC%BB%AC%EB%9F%AC-%EB%8B%A8%EC%A0%88%EA%B0%92"><span class="header-section-number">8.3.3</span> 컬러와 컬러 단절값</a></li>
  </ul>
</li>
  <li><a href="#ggplot2-%ED%8C%A8%ED%82%A4%EC%A7%80%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%A7%80%EB%8F%84-%EC%A0%9C%EC%9E%91" id="toc-ggplot2-패키지를-활용한-지도-제작" class="nav-link" data-scroll-target="#ggplot2-%ED%8C%A8%ED%82%A4%EC%A7%80%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%A7%80%EB%8F%84-%EC%A0%9C%EC%9E%91"><span class="header-section-number">8.4</span> ggplot2 패키지를 활용한 지도 제작</a></li>
  <li><a href="#tmap-%ED%8C%A8%ED%82%A4%EC%A7%80%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%A7%80%EB%8F%84-%EC%A0%9C%EC%9E%91" id="toc-tmap-패키지를-활용한-지도-제작" class="nav-link" data-scroll-target="#tmap-%ED%8C%A8%ED%82%A4%EC%A7%80%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%A7%80%EB%8F%84-%EC%A0%9C%EC%9E%91"><span class="header-section-number">8.5</span> tmap 패키지를 활용한 지도 제작</a></li>
  <li><a href="#%EC%9D%B8%ED%84%B0%EB%9E%99%ED%8B%B0%EB%B8%8C-%EC%A7%80%EB%8F%84-leaflet-mapview-tmap-%ED%8C%A8%ED%82%A4%EC%A7%80" id="toc-인터랙티브-지도-leaflet-mapview-tmap-패키지" class="nav-link" data-scroll-target="#%EC%9D%B8%ED%84%B0%EB%9E%99%ED%8B%B0%EB%B8%8C-%EC%A7%80%EB%8F%84-leaflet-mapview-tmap-%ED%8C%A8%ED%82%A4%EC%A7%80"><span class="header-section-number">8.6</span> 인터랙티브 지도: leaflet, mapview, tmap 패키지</a></li>
  <li><a href="#%EC%97%B0%EC%8A%B5%EB%AC%B8%EC%A0%9C" id="toc-연습문제" class="nav-link" data-scroll-target="#%EC%97%B0%EC%8A%B5%EB%AC%B8%EC%A0%9C"><span class="header-section-number">8.7</span> 연습문제</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/sangillee66/book_sds_trans/issues/new" class="toc-action"><i class="bi bi-github"></i>이슈 보고</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block"><span id="sec-plotting" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">공간데이터의 플로팅</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">2025년 8월 11일</p>
    </div>
  </div>
    
  </div>
  


</header><p>타임라인과 함께, 지도는 가장 강력한 그래프 가운데 하나다. 이는 지도상의 공간을 현실 공간(지금 어디에 있고, 한때 어디에 있었는지)과 독자가 즉시 연결할 수 있기 때문이다. 최근 시각화 관련 두 저작(Healy 2018; Wilke 2019)에는 지리공간 데이터 또는 지도의 시각화 방법을 다루는 장이 포함되어 있다. 본 장에서는 좋은/나쁜 지도를 평가하기 보다는, 지도를 제작하는 다양한 가능성과 그 과정에서 마주치는 도전 과제, 그리고 이를 해결할 수 있는 방법들을 살펴본다.</p>
<section id="sec-every" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="sec-every">
<span class="header-section-number">8.1</span> 모든 지도는 투영법을 가지고 있다.</h2>
<p>지구는 둥글지만, 플로팅 장치는 평면이다. 2.2.2절에서 언급했듯이, 어떤 방식으로든 평면 장치에 지구를 플로팅하는 순간 우리는 특정한 투영법을 적용한 것이다. 즉, 타원체 좌표를 특정한 방식으로 데카르트 좌표로 전환하는 것이다. 이는 우리가 아무것도 하지 않았다고 ‘생각하는’ 경우(역자주: 투영법을 적용하지 않았다고 생각하는 경우)(그림 8.1의 왼쪽)나, 우주에서 본 것처럼 세상을 ‘있는 그대로’ 보여준다고 ‘생각하는’ 경우(그림 8.1의 오른쪽)에도 마찬가지이다. 평면상의 모든 지도는 투영법을 갖는다.</p>
<div id="fig-8-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-8-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-world-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" data-glightbox="description: .lightbox-desc-1"><img src="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-world-1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-8-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;8.1: 국가 경계: 왼쪽은 경위도를 x, y 좌표로 선형 변환한 플라트 카레(Plate Carrée) 도법이며, 오른쪽은 무한히 먼 거리에서 지구를 바라본 것 처럼 표현한
</figcaption></figure>
</div>
<p>왼쪽 지도는 다음의 코드로 작성하였다.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rnaturalearth/">rnaturalearth</a></span><span class="op">)</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html">ne_countries</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"medium"</span>, returnclass <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>지구 전체를 타원체 좌표로 표현할 때, 사용되는 투영법이 기본 투영법임은 다음과 같이 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_is_longlat.html">st_is_longlat</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span>
<span><span class="co"># [1] TRUE</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>그림 8.1(왼쪽)에 사용된 투영법은 등장방형 도법(정거원통 도법)으로, 경도를 <span class="math inline">\(x\)</span>-축, 위도를 <span class="math inline">\(y\)</span>-축에 선형적으로 대응시켜 지도에서 가로<strong>ㆍ</strong>세로 방향의 거리 단위가 동일하게 유지되도록 한다.(역자주: 지구의 동서 범위는 360°, 남북 범위는 180°이므로, 이 지도의 가로세로비는 정확히 2:1이다) 따라서 지구의 일부 영역을 이 도법으로 플롯할 때에도 동서<strong>ㆍ</strong>남북 방향의 거리 단위가 동일하게 유지되도록 플롯 비율을 선택해야 한다. 이는 비투영 <code>sf</code> 또는 <code>stars</code> 데이터셋에 대한 <code>plot</code> 메서드의 기본 동작이며, <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">ggplot2::geom_sf()</a></code> 함수의 기본 설정이기도 하다(8.4절).(역자주: 비투영 객체는 경위도 좌표계를 가진 객체를 의미하며, 이를 <code>plot</code> 메서드를 통해 플롯하면 기본적으로 경위도 값을 좌표를 좌표처럼 취급한다. 지구 전체에 대해 이 방식으로 플롯하면 시각적으로 등장방형 도법과 동일하게 보인다.)</p>
<p>플로팅 전에 투영법을 적용해 데이터를 변형할 수도 있다. 예를 들어, 독일을 플로팅하려면 국가 경계 <code>sf</code> 객체로 불러온 후, <code><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform()</a></code> 함수로 원하는 투영법을 적용한다.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html">ne_countries</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">"germany"</span>,</span>
<span>                              returnclass <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">DE</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="st">"+proj=eqc +lat_ts=51.14 +lon_0=90w"</span><span class="op">)</span> <span class="op">-&gt;</span></span>
<span>    <span class="va">DE.eqc</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>여기서 <code>eqc</code>는 PROJ의 “등장방형 도법”을 의미한다. <code>lat_ts</code>는 투영 파라미터로, 표준 위선(축척의 왜곡이 <em>없는</em> 위선)의 위치를 지정한다. 이 표준 위선에서는 동서와 남북 방향의 길이 단위가 동일해진다. 일반적으로 이 값은 지도의 바운딩 박스의 중간 지점에 해당한다.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># [1] 51.14</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>그림 8.2의 두 지도를 비교해 보면, 축 값만 다를 뿐 두 지도는 동일하다. 왼쪽 지도는 타원체 좌표(도 단위)를, 오른쪽 지도는 투영 좌표(데카르트 좌표)(미터 단위)를 사용한다.</p>
<div id="fig-8-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-8-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-eqc-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" data-glightbox="description: .lightbox-desc-2"><img src="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-eqc-1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-8-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;8.2: 등장방형 도법이 적용된 독일. 왼쪽 지도의 단위는 도이고 정거원통 도법이 적용된 오른쪽 지도의 단위는 미터이다.
</figcaption></figure>
</div>
<section id="데이터에-맞는-투영법-고르기" class="level3" data-number="8.1.1"><h3 data-number="8.1.1" class="anchored" data-anchor-id="데이터에-맞는-투영법-고르기">
<span class="header-section-number">8.1.1</span> 데이터에 맞는 투영법 고르기</h3>
<p>안타깝게도 만능 해법은 없다. 모든 지점 모든 방향에서 축척이 동일한 투영법은 없으며, 이 속성은 오직 지구본만 갖는다. 널리 쓰이는 투영법은 보통 다음 중 하나를 보존한다:</p>
<ul>
<li><p>면적: 정적 도법</p></li>
<li><p>형태: 정형 도법(예: <em>메르카토르 도법</em>)(역자주: 형태가 유지되기 위해서는 각도가 유지되어야 하기 때문에 정각 도법이라고도 부른다.)</p></li>
<li><p>거리의 일부 속성: 등장방형 도법은 모든 지점의 경선 방향 거리를, <em>정거방위</em> 도법은 투영 원점으로부터의 거리를 보존한다.)</p></li>
</ul>
<p>또한 일부 도법은 두 속성의 절충을 지향한다.(역자주: 주로 면적과 형태를 절충하며, 이를 절충 도법이라 부른다. 대표적으로 로빈슨 도법과 빈켈 트리펠 도법이 있다) 투영 파라미터는 지도에서 어떤 지역을 중앙과 가장자리에 배치할지, 어느 지역을 위와 아래에 둘지, 어디가 가장 크게 확대될지를 결정한다. 이러한 선택을 돕는 가이드라인은 있으나 절대적인 규준은 없으며, 맥락에 따라 정치적 결단에 가까울 때도 있다.</p>
<p>다양한 투영법을 적용해 결과를 비교해 보는 일은 흥미롭고 교육적이다. 다만 지도 제작의 주된 목적이 투영법 자체에 대한 관심 충족이나 지식 축적이 아니라면, 널리 알려졌거나 최소한 덜 생소한 투영법을 선택해 ’어떤 투영법을 고를 것인가’에 머무르기 보다 ’선택한 투영법을 어떻게 적용할 것인가’로 논의를 진전시키는 편이 바람직하다. 한편 세계 지도를 위한 투영법 선택과 관련해서는 일정한 합의가 있다. 대부분의 경우, 정적 도법이 플라트 카레나 웹 메르카토르 도법보다 선호된다.</p>
</section></section><section id="포인트-라인-폴리곤-그리드-셀-플로팅" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="포인트-라인-폴리곤-그리드-셀-플로팅">
<span class="header-section-number">8.2</span> 포인트, 라인, 폴리곤, 그리드 셀 플로팅</h2>
<p>지도는 통계 데이터를 플로팅하는 특별한 형식으로 볼 수 있으므로, 플로팅의 일반 규칙이 지도에도 그대로 적용된다. 다만 지도 특유의 문제가 존재하며, 예를 들면 다음과 같다.</p>
<ul>
<li><p>매우 작은 폴리곤은 경우, 플로팅 시 사라질 수 있다.</p></li>
<li><p>데이터에 따라 지도 심볼이 서로 겹쳐 일부 심볼이 부분적으로만 보일 수 있다. 이때 투명도를 조정하면 겹친 심볼을 식별하는 데 도움이 된다.</p></li>
<li><p>포인트 피처 또는 포인트 심볼을 플로팅하는 경우, 포인트가 쉽게 겹쳐 다른 포인트 뒤에 완전히 가려질 수 있다. 이럴 때는 커널 밀도 지도(11장)가 더 유용할 수 있다.</p></li>
<li><p>라인 피처 또는 라인 심볼을 플로팅하는 경우, 색이 잘 구분되지 않을 수 있으며, 라인 너비와 무관하게 서로 겹칠 수 있다.</p></li>
</ul>
<section id="컬러" class="level3" data-number="8.2.1"><h3 data-number="8.2.1" class="anchored" data-anchor-id="컬러">
<span class="header-section-number">8.2.1</span> 컬러</h3>
<p>컬러 심볼이 적용된 폴리곤을 플로팅할 때는 폴리곤 경계를 표시할지 생략할지를 선택해야 한다. 경계선이 지나치게 눈에 띄면 회색 톤이나 폴리곤 컬러와 충돌이 덜한 색을 경계에 적용할 수 있다. 반대로 경계를 완전히 생략하면 (거의) 동일한 컬러의 폴리곤을 시각적으로 구별하기 어렵다. 컬러가 서로 다른 토지 피복 유형을 표현하는 경우에는 경계 생략이 큰 문제가 되지 않을 수 있다. 그러나 컬러가 집계값(예: 인구 수)의 크기를 표현한다면 지도 오독을 유발할 수 있다.(역자주: 인구 1,000명인 폴리곤이 서로 인접해 있을 때 경계를 없애면 마치 훨씬 넓은 지역의 인구가 여전히 1,000명인 것처럼 보일 수 있다) 특히 인구 수처럼 공간 외연 속성은 오독의 위험이 크다. 더 나아가, 이러한 속성은 경계를 유지하더라도 폴리곤 내부를 컬러로 채우는 콜로플레스 맵이 본질적으로 적절하지 않을 수 있다. 이는 컬러가 폴리곤이 가진 속성의 크기뿐 아니라 폴리곤의 면적도 함께 전달하기 때문이다.(역자주: 이런 이유로 공간 외연 속성은 코로플레스 맵이 아니라 도형표현도로 나타내는 것이 지도학적으로 합리적이다. 그럼에도 불구하고 총합이나 총빈도를 코로플레스 맵으로 표현한 지도가 인터넷에 넘쳐난다.)</p>
<p>연속형 컬러 스킴(컬러의 단절이 없는 팔레트)은 연속형 공간 현상을 표현할 때 주로 쓰이지만, 지도학적 실용성보다는 시각적 매력도가 우선되는 경우가 많다.(역자주: 연속형 공간 현상은 모든 지점에 존재하는 속성을 뜻하며, 기온이 대표적 예다.)</p>
<ul>
<li><p>지도에서 특정 컬러를 범례의 특정 값과 일대일로 맞추는 것은 인간의 시각 한계를 고려할 때 실용성이 크지 않다.(역자주: 연속형 컬러 스킴은 미세한 컬러 차이로 미세한 값 차이를 구분하게 하는데, 효과적인 정보 전달 측면에서 지도학적 실효성이 없다).</p></li>
<li><p>데이터 값의 범위와 컬러 범위가 비선형적으로 연결되는 일이 흔해, 값의 상대적 차이를 분간하기를 더 어렵게 만든다.</p></li>
</ul>
<p>따라서 값의 식별보다 공간적 현상의 연속성 재현이 더 중요한 한해 연속형 컬러 스킴의 사용이정당화될 수 있다. 대표적인 예는 고해상도 디지털 지형 모형을 채색으로 표현하는 경우다. 적절한 컬러 스킴과 팔레트는 <code><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors()</a></code> 또는 <code><a href="https://rdrr.io/r/grDevices/palette.html">palette.colors()</a></code> 함수에서 찾을 수 있으며, <strong>RColorBrewer</strong>(Neuwirth 2022), <strong>viridis</strong>(Garnier 2021), <strong>colorspace</strong>(Ihaka et al.&nbsp;2023; Zeileis et al.&nbsp;2020) 등의 패키지에서도 제공된다.</p>
</section><section id="컬러-단절값-classint" class="level3" data-number="8.2.2"><h3 data-number="8.2.2" class="anchored" data-anchor-id="컬러-단절값-classint">
<span class="header-section-number">8.2.2</span> 컬러 단절값: <code>classInt</code>
</h3>
<p>연속형 공간적 속성을 제한된 컬로(또는 기호)로 플로팅하려면, 데이터를 몇 개의 계급으로 구분해야 한다. R의 <strong>classInt</strong> 패키지(Bivand 2022)는 이를 수행하는 여러 방법을 제공하며, 기본값은 ’등개수 분류법(quantile)’이다.(역자주: 등개수 분류법은 각 계급에 동일한 개수의 관측치를 할당하는 방법이다.)</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/classInt/">classInt</a></span><span class="op">)</span></span>
<span><span class="co"># set.seed(1) if needed ?</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">cI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># style: quantile</span></span>
<span><span class="co">#   one of 1.49e+10 possible partitions of this variable into 8 classes</span></span>
<span><span class="co">#   [-2.29,-1.27)  [-1.27,-0.698) [-0.698,-0.426) [-0.426,-0.147) </span></span>
<span><span class="co">#              13              12              13              12 </span></span>
<span><span class="co">#  [-0.147,0.129)    [0.129,0.47)     [0.47,1.06)      [1.06,2.1] </span></span>
<span><span class="co">#              12              13              12              13</span></span>
<span><span class="va">cI</span><span class="op">$</span><span class="va">brks</span></span>
<span><span class="co"># [1] -2.290 -1.272 -0.698 -0.426 -0.147  0.129  0.470  1.059  2.105</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>classInt</strong> 패키지의 <code><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html">classIntervals()</a></code> 함수에서 <code>n</code> 아규먼트로 계급 수를 설정하고, <code>style</code> 아규먼트로 계급 구분 방식을 선택한다. 사용 가능한 옵션에 ‘fixed’, ‘sd’, ‘equal’, ‘pretty’, ‘quantile’, ‘kmeans’, ‘hclust’, ‘bclust’, ‘fisher’, ‘jenks’이다.(역자주: ’sd’는 표준편차 분류법, ’equal’은 등간격 분류법, ’fisher’와 ’jenks’는 자연단절 분류법, ’kmeans’, ‘hclust’, ’bclust’는 군집화 기반 계급 구분이다.) <code>n</code>을 지정했더라도 ’pretty’를 선택하면 무시될 수 있으며, <code>n</code>을 지정하지 않으면 <code><a href="https://rdrr.io/r/grDevices/nclass.html">nclass.Sturges()</a></code>가 사용된다. 자동으로 <code>n</code>을 선택하는 다른 방법도 제공된다. 관측치가 3,000개를 초과하면, ’fisher’와 ’jenks’에서는 10% 샘플을 사용해 계급을 산출한다.</p>
</section><section id="그래티큘-및-관련-요소" class="level3" data-number="8.2.3"><h3 data-number="8.2.3" class="anchored" data-anchor-id="그래티큘-및-관련-요소">
<span class="header-section-number">8.2.3</span> 그래티큘 및 관련 요소</h3>
<p>그래티큘(graticule)은 일정한 위도 또는 경도를 따라 지도상에 그어진 선의 네트워크이다. 그림 1.1에서는 회색으로, 그림 1.2에서는 흰색으로 표시되어 있다. 그래티큘은 기본적으로 위치에 대한 참조물로 지도에 그려진다. 예를 들어 그림 1.1의 첫 번째 지도에서는 플로팅된 지역이 북위 35도, 서경 80도 근처에 있음을 읽을 수 있다. 투영 좌표에 기반한 그래티큘은 모든 선이 직선으로 나타나고 좌표값이 특정 지점으로부터의 거리를 의미하므로, 경위도 그래티큘에 비해 쓰임새가 크지 않다.(역자주: 통상적으로 투영 좌표에 기반한 격자망은 그래티큘이 아니라 그리드(grid)라 부른다) 그래도 독자가 이러한 그래티큘에 익숙하고 좌표값의 단위가 제공된다면, 크기나 거리를 해석하는데 도움을 줄 수 있다. 그래티큘의 형태는 사용한 투영법의 특성을 반영한다. 따라서 그래티큘을 통해 투영법에 대한 정보를 유추할 수 있다. 등장방형 도법이나 메르카토르 도법은 수직선과 수평선을 갖고, 원추 도법은 경선이 직선(방사형)으로 나타나며 간격이 달라지고, 많은 정적 도법에서는 경선이 곡선으로 표현된다.(역자주: 이는 과도한 일반화일 수 있다. 세계 전체를 나타내는 타원형 형태의 정적 도법(예: 에케르트 IV 도법)에서는 경선이 곡선으로 표현되지만, 정적 원통 도법(정축의 경우)에서는 경위선이 모두 직선으로 나타난다).</p>
<p>그림 8.1과 다수의 다른 지도에서 실제 참조물 역할을 하는 것은 그래티큘이라기 보다는 주 경계, 국가 경계, 해안선, 강, 도로, 철도와 같은 지리적 요소들이다. 이러한 요소가 지도상에 적절히 배치된다면 그래티큘은 생략하는 편이 좋다. 그래티큘을 생략하면 일반 플롯의 중요 구성요소인 축, 눈금, 레이블도 사라지므로, 실질적인 지도 데이터로 채울 수 있는 플로팅 공간을 더 확보할 수 있다.</p>
</section></section><section id="베이스-plot" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="베이스-plot">
<span class="header-section-number">8.3</span> 베이스 <code>plot</code>
</h2>
<p><code>sf</code> 및 <code>stars</code> 객체에 적용되는 <code>plot</code> 메서드는 유용한 데이터 탐색용 플롯을 빠르고 간편하게 만들어 준다. 더 높은 품질과 사용자 자율성을 원한다면 <strong>ggplot2</strong>(Wickham et al.&nbsp;2022), <strong>tmap</strong>(Tennekes 2022, 2018), <strong>mapsf</strong>(Giraud 2022)와 같은 패키지를 활용하면 된다.</p>
<p><code>plot</code> 메서드의 기본값은 주어진 ’모든 것’을 플로팅하는 것이다. 이는 다음을 의미한다.</p>
<ul>
<li><p>지오메트리만 주어지면(<code>sfc</code>), 컬러 없이 지오메트리만 플로팅된다.</p></li>
<li><p>지오메트리와 속성이 함께 주어지면, 속성 값에 따라 지오메트리에 컬러가 부여된다. <code>factor</code>나 <code>logical</code> 속성에는 질적 컬러 스킴, 그 외에는 연속형 컬러 스킴이 적용되며 컬러 범례가 추가된다.</p></li>
<li><p>여러 속성이 주어지면 여러 지도가 플로팅된다. 색상 할당은 각 하위 지도별로 이루어지므로 지도마다 다른 컬러 스킴이 적용된다. 기본값으로 범례는 생략된다.</p></li>
<li><p>여러 속성을 가진 <code>stars</code> 객체의 경우 첫 번째 속성만 플로팅되며, 3차원 래스터 큐브의 경우 세 디멘션을 따라 생성되는 모든 슬라이스가 하위 플롯으로 플로팅된다.</p></li>
</ul>
<section id="플롯에-범례-첨가하기" class="level3" data-number="8.3.1"><h3 data-number="8.3.1" class="anchored" data-anchor-id="플롯에-범례-첨가하기">
<span class="header-section-number">8.3.1</span> 플롯에 범례 첨가하기</h3>
<p><code>stars</code> 및 <code>sf</code> 객체의 <code>plot</code> 메서드는 플롯 영역 한쪽에 컬러 범례를 표시할 수 있다(그림 1.1). 이를 위해 <code><a href="https://rdrr.io/r/base/plot.html">base::plot()</a></code> 함수는 플롯 영역을 두 부분으로 나누어 두 개의 플롯을 생성한다. 하나는 지도, 다른 하나는 범례다. <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> 함수는 기본값으로 그래픽 장치를 초기화하며(예: <code>layout(matrix(1)</code>) 이는 이후 플롯이 이전의 영역 분할 영향을 받지 않도록 하기 위한 설정이다. 그러나 이 때문에 이미 만들어진 플롯에 그래픽 요소를 추가할 수 없게 된다. 컬러 범례가 있는 기존 플롯에 요소를 <em>첨가</em>하려면, 먼저 <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> 명령에서 <code>reset = FALSE</code>로 장치 초기화를 막고, 이어지는 호출에서는 <code>add = TRUE</code>를 사용한다. 예시는 그림 8.3에 제시되어 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"gpkg/nc.gpkg"</span>, package <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nc</span><span class="op">[</span><span class="st">"BIR74"</span><span class="op">]</span>, reset <span class="op">=</span> <span class="cn">FALSE</span>, key.pos <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_buffer</a></span><span class="op">(</span><span class="va">nc</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html">set_units</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">km</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">'NA'</span>, </span>
<span>     border <span class="op">=</span> <span class="st">'red'</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-8-3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-8-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-figreset-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" data-glightbox="description: .lightbox-desc-3"><img src="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-figreset-1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-8-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;8.3: 범례가 있는 베이스 플롯에 주석 달기
</figcaption></figure>
</div>
<p><em>단일</em> <code>stars</code> 레이어가 표시되는 경우, 주석 추가는 같은 방식으로 수행된다. 여러 슬라이스를 가진 래스터 큐브의 <code>stars</code> 패싯 플롯에 주석을 더하려면, ‘후크(hook)’ 함수를 정의해 각 슬라이스마다 개별적으로 호출되도록 하면 된다.(역자주: ’후크 함수’는 <code>stars</code>의 <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>이 패싯의 각 슬라이스를 그린 직후 실행되는 사용자 정의 콜백이다. 이 함수 안에서 <code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code>, <code><a href="https://rdrr.io/r/graphics/points.html">points()</a></code>, <code><a href="https://rdrr.io/r/graphics/segments.html">segments()</a></code>, <code><a href="https://rdrr.io/r/graphics/box.html">box()</a></code> 같은 베이스 그래픽스를 호출해 레이블, 스케일바, 북침, 보조선 등을 패널마다 자동으로 추가할 수 있다.) 이는 다음과 같이 수행할 수 있으며, 결과는 그림 8.4에 제시되어 있다. 후크 함수는 패싯 파라미터, 패싯 레이블, 바운딩 박스에 접근할 수 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/">stars</a></span><span class="op">)</span></span>
<span><span class="co"># Loading required package: abind</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"tif/L7_ETMs.tif"</span>, package <span class="op">=</span> <span class="st">"stars"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html">read_stars</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">r</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_sample.html">st_sample</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_buffer</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">circ</span></span>
<span><span class="va">hook</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">circ</span>, col <span class="op">=</span> <span class="cn">NA</span>, border <span class="op">=</span> <span class="st">'yellow'</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">r</span>, hook <span class="op">=</span> <span class="va">hook</span>, key.pos <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co"># downsample set to 1</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-8-4" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-8-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-starshook-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" data-glightbox="description: .lightbox-desc-4"><img src="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-starshook-1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-8-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;8.4: 다중 슬라이스를 가진 <code>stars</code> 플롯에 주석 달기
</figcaption></figure>
</div>
<p>베이스 <code>plot</code> 메서드는 그래픽 장치의 해상도에 접근한다. 따라서 <code>stars</code> 및 <code>stars_proxy</code> 객체의 고밀도 래스터는 사용 중인 장치에 맞는 해상도로 다운샘플링되어, 해당 밀도로만 픽셀이 플로팅된다.</p>
</section><section id="베이스-플롯의-투영법" class="level3" data-number="8.3.2"><h3 data-number="8.3.2" class="anchored" data-anchor-id="베이스-플롯의-투영법">
<span class="header-section-number">8.3.2</span> 베이스 플롯의 투영법</h3>
<p>베이스 <code>plot</code> 메서드는 타원체 좌표를 가진 데이터를 등장방형 도법으로 플로팅하며(그림 8.2), 표준 위선 파라미터의 기본값으로 바운딩 박스의 중간 위도를 사용한다. 이 값을 제어하려면 플로팅 전에 다른 파라미터를 가진 등장방형 도법을 적용하거나 <code>asp</code> 파라미터를 직접 설정해 기본 동작을 해제하면 된다(예: <code>asp=1</code>은 플라트 카레 도법의 지도를 생성한다(그림 8.1 왼쪽)). 기존 플롯 위에 후속 플롯을 중첩하려면, 후속 플롯에도 동일한 CRS가 적용되어야 한다. 베이스 <code>plot</code> 메서드는 CRS 일치 여부를 검사하지 않는다.</p>
</section><section id="컬러와-컬러-단절값" class="level3" data-number="8.3.3"><h3 data-number="8.3.3" class="anchored" data-anchor-id="컬러와-컬러-단절값">
<span class="header-section-number">8.3.3</span> 컬러와 컬러 단절값</h3>
<p>베이스 <code>plot</code>에서는 <code>nbreaks</code> 아규먼트로 컬러 단절값의 개수를 설정하고, <code>breaks</code> 아규먼트로 제 컬러 단절값을 담은 숫자 벡터를 지정하거나, <code><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html">classInt::classIntervals()</a></code> 함수의 <code>style</code> 아규먼트에 전달할 스타일 문자열을 지정할 수 있다.</p>
</section></section><section id="ggplot2-패키지를-활용한-지도-제작" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="ggplot2-패키지를-활용한-지도-제작">
<span class="header-section-number">8.4</span> ggplot2 패키지를 활용한 지도 제작</h2>
<p><strong>ggplot2</strong> 패키지(Wickham 외, 2022; Wickham, 2016)는 더 복잡하면서도 보기 좋은 그래프를 만들 수 있게 해준다. 이 패키지에는 <strong>sf</strong> 패키지의 발전과 함께 도입된 <code>geom_sf</code> 레이어가 있어, 아름다운 지도를 만드는 데 도움을 준다. 이에 대한 소개는 Moreno와 Basille(2018)에서 찾을 수 있다. 첫 번째 예시는 그림 1.2에 나와 있으며, 이 플롯에 사용된 코드는 다음과 같다.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">nc.32119</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">nc</span>, <span class="fl">32119</span><span class="op">)</span> </span>
<span><span class="va">year_labels</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SID74"</span> <span class="op">=</span> <span class="st">"1974 - 1978"</span>, <span class="st">"SID79"</span> <span class="op">=</span> <span class="st">"1979 - 1984"</span><span class="op">)</span></span>
<span><span class="va">nc.32119</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">SID74</span>, <span class="va">SID79</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"SID"</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">nc_longer</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">nc_longer</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">name</span>, ncol <span class="op">=</span> <span class="fl">1</span>, </span>
<span>             labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html">labeller</a></span><span class="op">(</span>name <span class="op">=</span> <span class="va">year_labels</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">34</span><span class="op">:</span><span class="fl">36</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">sf.colors</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>코드를 살펴보면, 패싯 형태의 플롯팅을 위해 사전에 두 개의 속성을 <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> 함수로 스택(길게 피벗)했다는 것을 알 수 있다. 이것이 ‘타이디’ 데이터의 핵심 개념이며, <code>sf</code> 객체에 대한 <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> 함수는 지오메트리 열도 함께 스택한다.</p>
<p><strong>ggplot2</strong> 패키지는 그래픽 객체를 먼저 생성한 뒤 플롯팅하므로, 모든 요소의 CRS를 제어할 수 있으며 이후 추가되는 객체는 첫 번째 레이어의 CRS로 자동 변환된다. 또한 회색 배경의 얇은 흰색 선(기본값)으로 그래피큘을 표시하며, 특정 데이텀(기본값은 WGS84)을 사용한다. <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf()</a></code>는 다른 <code>geom</code>과 결합할 수 있어, 주석 추가 등 다양한 작업을 수행할 수 있다.</p>
<p><strong>stars</strong> 패키지의 경우, <code><a href="https://r-spatial.github.io/stars/reference/geom_stars.html">geom_stars()</a></code>가 존재하지만, 집필 시점 기준으로 활용성이 다소 제한적이다. 지도 레이아웃과 벡터 데이터 큐브는 <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf()</a></code>를 사용하고, 규칙 래스터는 <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster()</a></code>, 직교형 래스터는<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect()</a></code>를 추가로 사용한다. 사용자가 다운샘플링 비율을 지정하면 다운샘플링을 수행하지만, 화면 크기에 접근해 자동으로 비율을 선택하는 기능은 없다. 이 정도 기능만으로도 충분한 경우가 많으며, 예를 들어 그림 8.5는 다음 명령으로 생성되었다.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/">stars</a></span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html">read_stars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"tif/L7_ETMs.tif"</span>, package <span class="op">=</span> <span class="st">"stars"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/geom_stars.html">geom_stars</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">r</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">band</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-8-5" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-8-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-ggplotstars-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" data-glightbox="description: .lightbox-desc-5"><img src="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-ggplotstars-1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-8-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;8.5: <strong>ggplot2</strong>와 <code><a href="https://r-spatial.github.io/stars/reference/geom_stars.html">geom_stars()</a></code>로 제작된 단순 패싯 래스터 플롯
</figcaption></figure>
</div>
<p>더 정교한 <strong>ggplot2</strong> 패키지 기반의 <code>stars</code> 객체 플롯은 <strong>ggspatial</strong> 패키지(Dunnington, 2022)를 사용해 제작할 수 있다. 더 고품질의 지도를 만들기 위한 옵션으로 <strong>tmap</strong> 패키지가 있으며, <strong>ggplot2</strong>와 직접 호환되지는 않지만 형식적으로 유사한 스타일의 지도를 생성할 수 있다(8.5절).</p>
</section><section id="tmap-패키지를-활용한-지도-제작" class="level2" data-number="8.5"><h2 data-number="8.5" class="anchored" data-anchor-id="tmap-패키지를-활용한-지도-제작">
<span class="header-section-number">8.5</span> tmap 패키지를 활용한 지도 제작</h2>
<p><strong>tmap</strong> 패키지(Tennekes, 2022, 2018)는 R에서 공간데이터를 플로팅하는 참선한 접근을 제시한다. 이 패키지는 <strong>grid</strong> 패키지를 기반으로 그래픽 객체를 먼저 구성한 뒤 출력하며, 지도 요소를 <code>+</code> 기호로 연결하는 문법은 <strong>ggplot2</strong> 패키지와 유사하지만, 그 외에는 <strong>ggplot2</strong> 패키지와 완전히 독립적이고 상호 호환되지 않는다. 또한 고품질의 전문 지도를 만들 수 있는 다양한 옵션을 제공하며, 여러 기본값도 신중하게 설계되어 있다. 유사한 두 속성의 지도를 한번에 생성하려면 <code><a href="https://r-tmap.github.io/tmap/reference/tm_polygons.html">tm_polygons()</a></code> 함수에 두 변수를 동시에 지정하면 된다.(역자주: <strong>ggplot2</strong> 패키지로 지도를 제작하는 접근은 ’지도도 그래프다’라는 관점에 서 있다. <strong>tmap</strong> 패키지로 지도를 제작하는 접근은 ’지도는 지도다’라는 관점에 서 있다. <strong>tmap</strong> 패키지는 현존하는 여러 언어의 지도 제작 도구 가운데 지도학적 원칙을 가장 충실히 반영한 도구로 평가되며, 이는 R을 선택할 강력한 이유가 된다. 최근 <strong>tmap</strong> 4.0이 도입되면서 문법이 한층 정교해지고 기능이 보완되었다. 자세한 내용은 <a href="https://r-tmap.github.io/tmap/" class="uri">https://r-tmap.github.io/tmap/</a>를 참조하라.)</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-tmap/tmap">tmap</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"gpkg/nc.gpkg"</span>, package <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="st">'EPSG:32119'</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">nc.32119</span></span>
<span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">nc.32119</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SID74"</span>, <span class="st">"SID79"</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"SIDS"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_layout.html">tm_layout</a></span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>              panel.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1974-78"</span>, <span class="st">"1979-84"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_facets.html">tm_facets</a></span><span class="op">(</span>free.scales<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-8-6" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-8-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-tmapnc-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" data-glightbox="description: .lightbox-desc-6"><img src="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-tmapnc-1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-8-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;8.6: <strong>tmap</strong>: <code>tm_polygon()</code> 함수에 두 개의 속성을 동시에 지정하여 플로팅하기
</figcaption></figure>
</div>
<p>또는 <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> 함수로 얻은 긴 테이블 형식 데이터에 <code>tm_polygons("SID")</code> 와 <code>tm_facets(by = "name")</code>를 조합해도 동일한 지도를 생성할 수 있다.</p>
<p><strong>tmap</strong> 패키지는 <code>stars</code> 객체도 지원하며, 예시는 그림 8.7에 제시되어 있다. <strong>tmap</strong> 패키지를 활용한 추가 사례 지도는 14~16장에 제시되어 있다.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_raster.html">tm_raster</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-8-7" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-8-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-tmapstars-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" data-glightbox="description: .lightbox-desc-7"><img src="https://r-spatial.org/book/08-Plotting_files/figure-html/fig-tmapstars-1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-8-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;8.7: <strong>tmap</strong> 패키지를 활용해 제작한 단순한 래스터 플롯
</figcaption></figure>
</div>
</section><section id="인터랙티브-지도-leaflet-mapview-tmap-패키지" class="level2" data-number="8.6"><h2 data-number="8.6" class="anchored" data-anchor-id="인터랙티브-지도-leaflet-mapview-tmap-패키지">
<span class="header-section-number">8.6</span> 인터랙티브 지도: leaflet, mapview, tmap 패키지</h2>
<p>그림 1.3과 같은 인터랙티브 지도는 R의 <strong>leaflet</strong>, <strong>mapview</strong>, <strong>tmap</strong> 패키지를 사용해 생성할 수 있다. <strong>mapview</strong> 패키지는 <strong>leaflet</strong> 패키지의 기본 기능을 확장하여 지도 범례, 피처 클릭 팝업의 세부 조정, 래스터 데이터 지원, FlatGeobuf 형식의 대규모 피처 세트를 위한 스케일러블 지도, 줌과 팬 동기화에 반응하는 패싯 지도를 제공한다. <strong>tmap</strong> 패키지는 두 가지 모드를 지원하여 다음과 같이 <code>'view'</code>를 지정하면, 모든 <strong>tmap</strong> 명령이 상호작용형 html/leaflet 위젯에 적용된다.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tmap_mode.html">tmap_mode</a></span><span class="op">(</span><span class="st">"view"</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>반면 ’plot’을 지정하면, 모든 결과물은 다시 R의 정적 그래픽 장치로 출력된다.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tmap_mode.html">tmap_mode</a></span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="연습문제" class="level2" data-number="8.7"><h2 data-number="8.7" class="anchored" data-anchor-id="연습문제">
<span class="header-section-number">8.7</span> 연습문제</h2>
<ol type="1">
<li><p>인도네시아와 캐나다에 대해 등장방형 도법, 정사 도법, 그리고 람베르트 정적원추 도법을 적용한 지도 플롯을 생성하시오. 각 투영법에 대해 해당 국가에 적절한 투영 파라미터를 선택하시오.</p></li>
<li><p>그림 8.3의 플롯을 <strong>ggplot2</strong> 패키지와 <strong>tmap</strong> 패키지를 각각 사용하여 재생성하시오.</p></li>
<li><p>그림 8.7의 플롯을 <code>viridis</code> 색상 팔렡트로 재생성하시오.</p></li>
<li><p><strong>tmap</strong>의 인터랙티브 모드(‘view’ 모드)를 사용하여 그림 8.7을 디시 플로팅하고, 가능한 상호작용을 탐색하시오. 또한 + <code>tm_facets(as.layers=TRUE)</code>를 추가한 후 레이어의 켜기/끄기를 시험하고, 투명도를 0.5로 설정하시오.</p></li>
</ol>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">그림&nbsp;8.1: 국가 경계: 왼쪽은 경위도를 x, y 좌표로 선형 변환한 플라트 카레(Plate Carrée) 도법이며, 오른쪽은 무한히 먼 거리에서 지구를 바라본 것 처럼 표현한</span>
<span class="glightbox-desc lightbox-desc-2">그림&nbsp;8.2: 등장방형 도법이 적용된 독일. 왼쪽 지도의 단위는 도이고 정거원통 도법이 적용된 오른쪽 지도의 단위는 미터이다.</span>
<span class="glightbox-desc lightbox-desc-3">그림&nbsp;8.3: 범례가 있는 베이스 플롯에 주석 달기</span>
<span class="glightbox-desc lightbox-desc-4">그림&nbsp;8.4: 다중 슬라이스를 가진 <code>stars</code> 플롯에 주석 달기</span>
<span class="glightbox-desc lightbox-desc-5">그림&nbsp;8.5: <strong>ggplot2</strong>와 <code><a href="https://r-spatial.github.io/stars/reference/geom_stars.html">geom_stars()</a></code>로 제작된 단순 패싯 래스터 플롯</span>
<span class="glightbox-desc lightbox-desc-6">그림&nbsp;8.6: <strong>tmap</strong>: <code>tm_polygon()</code> 함수에 두 개의 속성을 동시에 지정하여 플로팅하기</span>
<span class="glightbox-desc lightbox-desc-7">그림&nbsp;8.7: <strong>tmap</strong> 패키지를 활용해 제작한 단순한 래스터 플롯</span>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./07.html" class="pagination-link  aria-label=" stars="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">sf와 stars 패키지</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09.html" class="pagination-link" aria-label="<span class='chapter-number'>9</span>&nbsp; <span class='chapter-title'>대규모 데이터와 클라우드 네이티브</span>">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">대규모 데이터와 클라우드 네이티브</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/sangillee66/book_sds_trans/issues/new" class="toc-action"><i class="bi bi-github"></i>이슈 보고</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"selector":".lightbox","descPosition":"bottom","openEffect":"zoom","loop":false,"closeEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>


</body></html>