{
  "hash": "ead7b17f22b742ae7c620a396286e85e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ndate-modified: last-modified\nnumber-sections: false\nformat: \n  html: \n    toc: true\ncode-link: true\ncode-copy: true\nexecute: \n  warning: false\n  error: false\n  freeze: auto\neditor: visual\n---\n\n\n# 오래된 공간 R 패키지 {#sec-package}\n\n## rgdal과 rgeos 패키지의 퇴역\n\n당신이 오랜 R 사용자, 특히 **sf**와 **stars** 같은 패키지가 개발되기 이전부터 R을 사용해 왔다면, **maptools**, **sp**, **rgeos**, **rgdal** 같은 오래된 패키지에 더 익숙할 수 있다. 기존 코드나 오래된 패키지에 의존하는 다른 R 패키지를 새롭게 갱신해야할 필요가 있는지를 궁금해하는 것은 당연한다. 그에 대한 답은 '그렇다'이다.\n\n**maptools**, **rgdal**, **rgeos** 패키지는 2023년 중에 퇴역할 예정이다. 퇴역의 의미는 유지보수가 중단되고, 그 결과로 해당 패키지들이 CRAN에서 아카이브로 전환된다는 것이다. 하지만 소스 코드 저장소는 R-Forge가 유지되는 한 계속 남아 있을 것이다. 퇴역의 한 가지 이유는 관리자가 은퇴했기 때문이고, 더 중요한 이유는 이들 패키지의 역할이 더 새로운 패키지들로 대체되었기 때문이다. 새로운 관리자가 R-Forge 저장소를 인계받을 가능성은 매우 낮아 보인다. 이는 부분적으로 GEOS, GDAL, PROJ 라이브러리의 발전과 함께 이들 패키지의 코드가 점진적으로 변화해 왔으며, 많은 코드가 시대에 뒤떨어진 구조를 포함하고 있어 읽기 어렵기 때문이다.\n\n**rgeos**와 **rgdal**이 퇴역하기 전에, **sp** 패키지가 **rgdal** 및 **rgeos**와 가지고 있는 기존 연결성은 **sf** 패키지와의 연결성으로 대체될 수 있으며, 실제로 대체될 예정이다. 이는 예를 들어 좌표참조계(CRS) 식별자의 검증, 링이 내부 홀인지 외부 링인지 확인하는 작업 등을 포함한다. **maptools**의 일부 선택된 함수는 **sp**로 이전될 가능성도 있다.\n\n## sf와 sp 패키지의 연결성 및 차별성\n\n**sf**와 **sp**에는 여러 차이가 있다. 가장 눈에 띄는 차이는 **sp** 클래스는 정형적인 S4 클래스를 사용하는 반면, **sf**는 보다 비공식적인 S3 클래스 계층을 사용한다는 점이다. **sf** 객체는 `data.frame` 또는 `tibble`에서 파생되며, 이로 인해 기존 R 생태계, 특히 **tidyverse** 패키지 계열과 더 쉽게 연동할 수 있다. `sf` 객체는 기하 데이터를 리스트-컬럼에 저장하며, 이는 기하 데이터가 항상 리스트 요소로 유지됨을 의미한다. 반면, **sp**는 데이터 구조를 덜 엄격하게 사용하며, 예를 들어 `SpatialPoints`나 `SpatialPixels`의 모든 좌표를 행렬에 저장한다. 이는 특정 문제에 대해 더 높은 성능을 제공하지만 리스트-컬럼으로는 구현할 수 없는 방식이다. `sf` 객체 `x`를 **sp**로 변환하려면 다음과 같이 하면 된다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sp)\ny = as(x, \"Spatial\")\n```\n:::\n\n\n그리고 반대로 `sp` 객체를 **sf**로 변환하려면 다음과 같이 하면 된다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx0 = st_as_sf(y)\n```\n:::\n\n\n이러한 변환에는 몇 가지 제한 사항이 있다.\n\n-   **sp**는 `LINESTRING`과 `MULTILINESTRING` 지오메트리, 또는 `POLYGON`과 `MULTIPOLYGON` 지오메트리를 구분하지 않는다. 예를 들어, `LINESTRING`을 `sp`로 변환한 후 다시 변환하면 `MULTILINESTRING`으로 반환된다.\n\n-   **sp**는 `GEOMETRYCOLLECTION` 지오메트리를 가지고 있지 않으며, “빅 세븐” (3.1.1절) 범주에 포함되지 않는 지오메트리를 가진 `sf` 객체를 표현할 수 있는 구조를 가지고 있지 않다.\n\n-   `sf` 또는 `sfc` 객체 중 혼합된 지오메트리를 가진 `GEOMETRY` 유형인 경우, 이를 `sp` 객체로 변환할 수 없다.\n\n-   속성-지오메트리 관계 속성은 **sp**로 변환할 때 손실된다.\n\n-   두 개 이상의 지오메트리 리스트-컬럼을 가진 sf 객체는 **sp**로 변환할 때 부차적인 리스트-컬럼을 잃게 된다.\n\n## 마이그레이션을 위한 코드와 패키지\n\n**sf**의 GitHub 사이트 위키 페이지(<https://github.com/r-spatial/sf/wiki/Migrating>)에는 **rgeos**, **rgdal**, **sp**의 메서드 및 함수와 그에 상응하는 **sf** 메서드 및 함수의 목록이 포함되어 있다. 이는 기존 코드나 패키지를 변환하는 데 도움이 될 수 있다.\n\n코드를 마이그레이션하는 간단한 방법은 **rgdal** 패키지의 `readOGR()` 함수만 사용하여 파일을 읽는 경우이다. 다른 대안은 **sf** 패키지의 `read_sf()` 함수를 사용하는 것이다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx = as(sf::read_sf(\"file\"), \"Spatial\")\n```\n:::\n\n\n그러나 `readOGR()` 함수를 사용할 때는 아규먼트를 보다 주의해서 다뤄야 한다. 우리는 **rgdal**, **rgeos**, **maptools** 없이 전체적으로 실행되도록, 가능하면 **sp** 없이 실행되도록, 이전 책인 *Applied Spatial Data Analysis with R* (Virgilio Gómez-Rubio, Bivand, Pebesma, Gómez-Rubio, 2013)의 모든 코드를 변환하는 작업을 진행 중이다. 해당 스크립트는 <https://github.com/rsbivand/sf_asdar2ed>에서 확인할 수 있다.\n\n## raster와 terra 패키지\n\n**raster** 패키지는 2010년부터 R을 사용한 래스터 데이터 분석의 핵심적인 패키지였으며, 이후 \"Geographic Data Analysis and Modeling\" (Hijmans 2023a) 패키지로 성장하여 모든 종류의 공간 데이터에 사용되고 있다. **raster** 패키지는 벡터 데이터를 위해 **sp** 객체를 사용하고, GDAL 라이브러리가 제공하는 형식으로 데이터를 읽고 쓸 때 **terra**를 사용한다. 후속 패키지인 **terra**는 \"Spatial Data Analysis\" (Hijmans 2023b)를 위한 패키지로, \"raster 패키지와 매우 비슷하지만 \\[…\\] 더 많은 기능을 제공하며, 사용하기 더 쉽고, \\[…\\] 더 빠르다.\" **terra** 패키지는 벡터 데이터를 위한 자체 클래스를 가지고 있지만 많은 **sf** 객체를 받아들인다. 물론 위에서 열거한 **sp** 변환 시에 발생하는 것과 유사한 제한 사항이 부과된다. **terra** 패키지는 GDAL, GEOS, PROJ와의 직접적인 연결을 가지고 있어, 더 이상 다른 패키지가 필요 없다.\n\n**raster** 또는 **terra** 패키지의 래스터 레이어나 래스터 스택은 `st_as_stars()` 함수를 사용하여 `stars` 객체로 변환할 수 있다. **sf** 패키지의 `st_as_sf()` 함수를 통해 **terra** 패키지의 `SpatVector` 객체를 변환할 수 있다.\n\n로버트 히즈먼(Robert Hijmans)이 저술한 온라인 책 *Spatial Data Science with R*(<https://rspatial.org/terra>)은 **terra**를 활용한 공간 데이터 분석 방법을 자세히 설명하고 있다. **sf**와 **stars** 패키지 및 이 책에서 다루는 여러 r-spatial 패키지들은 `r-spatial` GitHub 조직에 속해 있다(여기서 `r`과 `spatial` 사이에 하이픈이 있다는 점에 유의하라. 히즈먼의 조직에는 하이픈이 없다). 해당 조직은 블로그 사이트가 있으며, 이 책에 대한 링크가 <https://r-spatial.org/book>에서 제공된다.\n\n**sf**와 **stars** 패키지, 그리고 **terra** 패키지는 많은 공통된 목표를 가지고 있지만, 약간 다른 방식으로 이를 달성하려고 하며, 데이터 분석, 소프트웨어 엔지니어링, 커뮤니티 관리에 대한 상이한 강조점을 가지고 있다. 이러한 차이점이 일부 사용자들에게 혼란을 줄 수 있지만, 우리는 이러한 차이점들이 R 패키지 생태계를 풍요롭게 하고, 사용자에게 유익하며, 다양성과 선택을 장려한다고 믿는다. 또한 이는 사용자가 R을 공간 데이터 문제에 사용할 때 새로운 아이디어를 계속 시도하도록 유도하고, 결국 R spatial의 깃발을 만천하에 더 높이는데 기여할 것으로 믿는다.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}