---
date-modified: last-modified
number-sections: true
format: 
  html: 
    toc: true
code-link: true
code-copy: true
execute: 
  warning: false
  error: false
  freeze: auto
editor: visual
---

# 공간적 회귀분석 {#sec-regression}

에어리어 서포트를 가지는 한 변수가 주어졌을 때 그것이 보여주는 공간적 패턴의 해석에 집중하는 것은 의미있는 일이다. 그러나 해당 변수의 공간적 패턴을 설명하고자 한다면, 즉 해당 변수를 반응 변수로 간주한다면 얘기는 좀 달라진다. 왜냐하면 반응 변수과 보여주는 공간적 패턴을 주로 공변량(및 그 함수 형태)에 기인한 것일 가능성이 크고, 개별 변수의 영향력이 작동하는 공간적 범위에 영향을 받기 때문이다. 이차원 공간적 자기회귀 모델은 공변량 없이 시작되었으며, 시계열 분석 모델과 명확한 연관성을 가지고 있다(Whittle, 1954). 이후 선형 모델 잔차에서 공간적 자기상관을 검정하는 방법과 자기회귀 성분을 반응 변수나 잔차에 적용하는 모델로 확장되었는데, 자기회귀 성분을 잔차에 적용하는 모델은 잔차에 대한 검정과 일치하는 것이었다(Cliff and Ord, 1972, 1973). 이러한 에어리어 데이터에 대한 "격자(lattice)" 모델은 일반적으로 연접성 행렬 형태의 이웃 관계 그래프를 사용하여 관측값 간의 공간적 의존성을 나타낸다.

물론, 일반화 최소제곱 모델이나 **nlme** 및 기타 여러 패키지에서 제공하는 (일반화) 선형 또는 비선형 혼합효과 모델에서 공간적 자기상관을 다루는 데 반드시 이웃 관계 그래프를 사용할 필요는 없다(Pinheiro and Bates, 2000). 관측값 간의 거리 함수를 사용하거나 공간적 자기상관을 모델링하기 위해 베리오그램을 적합하는 것 역시 공간적 회귀 모델의 일종이라고 말할 수 있다. 이러한 접근은 기저 과정에 대한 더 명확한 이해를 제공한다고 평가되었으며(Wall, 2004), 지구통계학에 기반을 두고 있다. 예를 들어, **glmmTMB** 패키지는 이 접근법을 활용해 공간적 회귀분석을 성공적으로 수행한다(Brooks et al., 2017). 하지만 본 장에서는 공간 가중치 행렬을 사용하는 공간적 회귀분석만을 고려할 것이다.

## 마르코프 랜덤 필드와 다수준 모델

$$
Y=X\beta+Zu+\epsilon
$$

$$
\Sigma^{-1}=[(I-\rho W)'(I-\rho W)]
$$

$$
\Sigma^{-1}=(I=\rho W)
$$

$$
\Sigma^{-1}=M=\text{diag}(n_i)-W
$$

$$
\Sigma^{-1}=[(1-\rho)I_n+
\rho M]
$$

### 보스턴 주택가격 데이터셋

## 보스턴 데이터셋에 대한 다수준 모델

### IID 랜덤 효과: lme4 패키지의 활용

### IID와 CAR 랜덤 효과: hglm 패키지의 활용

### IID와 ICAR 랜덤 효과: R2BayesX 패키지의 활용

### IID, ICAR, Lerouzx 랜덤 효과: INLA 패키지의 활용

### ICAR 랜덤 효과: mgcv 패키지의 gam() 함수의 활용

### 상위-수준 랜덤 효과: 요약

## 연습문제
